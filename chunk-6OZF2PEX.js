import{a as ve,b as be}from"./chunk-3CZLDSUV.js";import{a as te,b as ie,c as M}from"./chunk-ODTFD3QQ.js";import"./chunk-TVFTUAXU.js";import{B as x,a as le,l as me,m as I,n as pe,o as ue,p as fe,s as he,z as ge}from"./chunk-GXGAIHHQ.js";import"./chunk-ZRB5JYID.js";import"./chunk-XQ5SMVZC.js";import"./chunk-6DNDLIQE.js";import"./chunk-FTJNOPBC.js";import{d as ee}from"./chunk-NELNUKEX.js";import{d as de,e as ce}from"./chunk-53BCAK53.js";import{d as se,e as w}from"./chunk-KZGPV3OV.js";import"./chunk-MROZGMZP.js";import"./chunk-6MWK2YGG.js";import"./chunk-S23T3VNK.js";import"./chunk-ZSZR532A.js";import{d as f,g as _,h as oe,j as re,l as ne,o as T,v as ae,w as D,x as F}from"./chunk-3IAGLYRS.js";import{g as C,k as V}from"./chunk-56NTXRTG.js";import{m as R}from"./chunk-DIBFAAWP.js";import{Ab as u,Bb as k,C as h,M as g,Ra as p,Rc as Z,S as q,Sa as n,Sb as X,T as v,Tb as Y,Uc as y,Vb as A,X as H,ba as b,ca as S,d as N,dc as $,ec as B,gb as Q,ib as c,j as P,la as J,ma as K,ob as U,r as z,tb as l,ub as a,vb as d,zb as W}from"./chunk-UISEBZIM.js";var j=class{constructor(m){this.id=m.id,this.name=m.name,this.address=m.name,this.local=m.local,this.phone=m.phone}};var G=(()=>{class i{constructor(e){this.apiService=e,this.vendors=[],this.total=0,this.vendors$=new P(this.vendors),this.total$=new P(this.total)}callGetList(e=10,t=1,o=""){let r=`vendors?limit=${e}&page=${t}`;return o&&(r+=`&search=${o}`),this.apiService.get(r).pipe(h(600),z(s=>{this.updateVendors(s.data),this.updateTotalVendors(s.paginate.total)}))}getList(){return this.vendors$.asObservable()}getTotal(){return this.total$.asObservable()}getOne(e){return this.apiService.get(`vendors/${e}`)}create(e){return this.apiService.post("vendors",e).pipe(g(()=>this.callGetList()))}edit(e,t){return this.apiService.patch(`vendors/${e}`,t).pipe(g(()=>this.callGetList()))}delete(e){return this.apiService.delete(`vendors/${e}`).pipe(g(()=>this.callGetList()))}updateVendors(e){this.vendors=e,this.vendors$.next(this.vendors)}updateTotalVendors(e){this.total=e,this.total$.next(this.total)}static{this.\u0275fac=function(t){return new(t||i)(H(ee))}}static{this.\u0275prov=q({token:i,factory:i.\u0275fac,providedIn:"root"})}}return i})();function De(i,m){if(i&1){let e=W();l(0,"form",1),u("ngSubmit",function(){J(e);let o=k();return K(o.buttonSaveVendor())}),l(1,"div",2)(2,"div",3),d(3,"app-input-text",4),a(),l(4,"div",3),d(5,"app-input-text",5),a(),l(6,"div",3),d(7,"app-input-text",6),a(),l(8,"div",3),d(9,"app-input-text",7),a(),d(10,"button",8),a()()}if(i&2){let e=k();c("formGroup",e.form),p(10),c("disabled",!e.isValid)}}var O=(()=>{class i{constructor(e,t,o,r){this.formBuilder=e,this.vendorsService=t,this.dynamicDialogRef=o,this.dynamicDialogConfig=r,this.form=this.formBuilder.group({name:["",f.required],address:["",f.nullValidator],local:["",f.nullValidator],phone:["",f.nullValidator]})}ngOnInit(){if(this.dynamicDialogConfig.data.id){let e=this.dynamicDialogConfig.data.id;this.vendorsService.getOne(e).subscribe(t=>{this.form.patchValue(t)})}}get isValid(){return this.form.valid}buttonSaveVendor(){if(this.form){let e=new j(this.form.value);if(this.dynamicDialogConfig.data.id){let t=this.dynamicDialogConfig.data.id;this.vendorsService.edit(t,e).subscribe({next:()=>this.dynamicDialogRef.close(),error:()=>{}})}else this.vendorsService.create(e).subscribe({next:()=>{this.dynamicDialogRef.close({success:!0}),this.form.reset()},error:()=>{}})}}static{this.\u0275fac=function(t){return new(t||i)(n(ae),n(G),n(ie),n(te))}}static{this.\u0275cmp=b({type:i,selectors:[["app-vendor-form"]],decls:1,vars:1,consts:[[3,"formGroup"],[3,"ngSubmit","formGroup"],[1,"p-fluid","p-formgrid","grid"],[1,"col-12"],["label","Nombre","for","name","type","text","id","name","placeholder","Ingresa el nombre","controlName","name"],["label","Celular","for","phone","type","text","id","phone","placeholder","Ingresa el celular","controlName","phone"],["label","Direcci\xF3n","for","address","type","text","id","address","placeholder","Ingresa la direcci\xF3n","controlName","address"],["label","Galer\xEDa","for","local","type","text","id","local","placeholder","Ingresa la galer\xEDa","controlName","local"],["type","submit","pButton","","label","Guardar",1,"mt-3",3,"disabled"]],template:function(t,o){t&1&&Q(0,De,11,2,"form",0),t&2&&U(0,o.form?0:-1)},dependencies:[de,ne,_,le,T]})}}return i})();var Fe=()=>[],we=()=>[10,20,50],ye=(()=>{class i{constructor(e,t,o,r,s){this.dialogService=e,this.vendorsService=t,this.messageService=o,this.confirmationService=r,this.loadingService=s,this.columns=[],this.data=[],this.limit=10,this.page=1,this.name="",this.callToAction=[{type:"button",size:"small",icon:"pi pi-pencil",outlined:!0,pTooltip:"Editar",tooltipPosition:"bottom",click:L=>this.buttonEditVendor(L.id)},{type:"button",size:"small",icon:"pi pi-trash",outlined:!0,pTooltip:"Eliminar",tooltipPosition:"bottom",click:(L,Ve)=>this.buttonDeleteVendor(L.id,Ve)}],this.formGroup=new oe({search:new re(null)})}ngOnInit(){this.columns=[{header:"#",field:"id",clickable:!1,image:!1,money:!1},{header:"Nombre",field:"name",clickable:!1,image:!1,money:!1},{header:"Celular",field:"phone",clickable:!1,image:!1,money:!1},{header:"Direcci\xF3n",field:"address",clickable:!1,image:!1,money:!1},{header:"Galer\xEDa",field:"local",clickable:!1,image:!1,money:!1},{field:"button",header:"Acci\xF3n",clickable:!1,image:!1,money:!1}],this.getVendors(this.limit,this.page,this.name),this.formGroup.get("search")?.valueChanges.pipe(h(600)).subscribe(e=>{this.name=e||"",this.loadingService.sendLoadingState(!0),this.getVendors(this.limit,this.page,this.name)})}ngOnDestroy(){this.vendorModal&&this.vendorModal.close()}clearFilter(){this.name="",this.loadingService.sendLoadingState(!0),this.formGroup.get("search")?.setValue("")}updatePage(e){this.page=e}getVendors(){return N(this,arguments,function*(e=this.limit,t=this.page,o=this.name){this.updatePage(t),this.vendorsService.callGetList(e,t,o).subscribe(),setTimeout(()=>{this.loadingService.sendLoadingState(!1)},600)})}get vendors(){return this.vendorsService.getList()}get total(){return this.vendorsService.getTotal()}onPageSelected(e){return N(this,null,function*(){this.updatePage((e.page??0)+1),this.getVendors(e.rows,this.page)})}buttonAddVendor(){this.vendorModal=this.dialogService.open(O,{data:{},header:"Crear"}),this.vendorModal.onClose.subscribe({next:e=>{e&&e?.success?this.showSuccess("Role Creado."):e?.error&&this.showError(e?.error)}})}buttonEditVendor(e){this.vendorModal=this.dialogService.open(O,{data:{id:e},header:"Editar"}),this.vendorModal.onClose.subscribe({next:t=>{t&&t?.success?this.showSuccess("Role actualizado."):t?.error&&this.showError(t?.error)}})}buttonDeleteVendor(e,t){this.confirmationService.confirm({target:t.target,message:"Deseas eliminar este proveedor?",header:"Eliminar proveedor",icon:"pi pi-info-circle",acceptButtonStyleClass:"p-button-danger p-button-text",rejectButtonStyleClass:"p-button-text p-button-text",acceptIcon:"none",rejectIcon:"none",acceptLabel:"Si",rejectLabel:"No",accept:()=>{this.vendorsService.delete(e).subscribe(()=>{this.showSuccess("El rol ha sido eliminado")})},reject:()=>{}})}showSuccess(e){this.messageService.add({severity:"success",summary:"Confirmado",detail:e,life:3e3})}showError(e){this.messageService.add({severity:"error",summary:"Error",detail:e,life:3e3})}static{this.\u0275fac=function(t){return new(t||i)(n(M),n(G),n(V),n(C),n(ue))}}static{this.\u0275cmp=b({type:i,selectors:[["app-vendors"]],standalone:!0,features:[X([C,V]),Y],decls:10,vars:15,consts:[[1,"card"],[1,"flex","justify-content-between","align-items-center","mt-3","gap-3"],["controlName","search",1,"w-full","md:w-3",3,"clearFilter","formGroup"],[3,"click","outlined"],[1,"pi","pi-plus",2,"font-size","1rem"],[3,"paginateSelected","data","columns","callToAction","cellToAction","total","limit","rowsPerPageOptions"]],template:function(t,o){if(t&1&&(l(0,"div",0)(1,"div",1)(2,"app-input-search",2),u("clearFilter",function(){return o.clearFilter()}),a(),l(3,"p-button",3),u("click",function(){return o.buttonAddVendor()}),d(4,"i",4),a()(),l(5,"app-table-pagination",5),$(6,"async"),$(7,"async"),u("paginateSelected",function(s){return o.onPageSelected(s)}),a(),d(8,"p-toast")(9,"p-confirmDialog"),a()),t&2){let r,s;p(2),c("formGroup",o.formGroup),p(),c("outlined",!0),p(2),c("data",(r=B(6,9,o.vendors))!==null&&r!==void 0?r:A(13,Fe))("columns",o.columns)("callToAction",o.callToAction)("cellToAction",o.cellToAction)("total",(s=B(7,11,o.total))!==null&&s!==void 0?s:0)("limit",o.limit)("rowsPerPageOptions",A(14,we))}},dependencies:[y,Z,D,_,F,T,I,me,ce,w,se,x,fe,ge]})}}return i})();var Ie=[{path:"",component:ye},{path:"",pathMatch:"full",redirectTo:"vendors"}],Ce=(()=>{class i{static{this.\u0275fac=function(t){return new(t||i)}}static{this.\u0275mod=S({type:i})}static{this.\u0275inj=v({imports:[R.forChild(Ie),R]})}}return i})();var gt=(()=>{class i{static{this.\u0275fac=function(t){return new(t||i)}}static{this.\u0275mod=S({type:i})}static{this.\u0275inj=v({providers:[M],imports:[y,Ce,x,D,F,w,I,ve,be,pe,he]})}}return i})();export{gt as VendorsModule};
