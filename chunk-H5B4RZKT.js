import{d as ue}from"./chunk-SU5FXICQ.js";import{b as A,f as Q,k as N,m as fe,u as R}from"./chunk-CR7W443G.js";import{Aa as p,Ab as P,B as E,C as U,Ga as ae,H as g,Ha as se,I as x,Ia as le,Ka as l,La as M,Ma as b,Na as ce,Oa as X,Pa as J,Qa as Z,Sa as I,Tb as ee,V as c,a as K,b as Y,ca as w,cb as T,d as O,eb as V,f as ie,fa as y,ha as $,ia as G,ja as v,k as H,lb as z,mb as de,na as k,nb as pe,pa as re,q as ne,qa as D,ra as L,sa as o,ta as a,ua as u,ub as me,v as oe,w as W,ya as S,z as C,za as m,zb as j}from"./chunk-DIPV63T5.js";var F=(()=>{class n{constructor(){this.apiService=C(ue),this.cart=w([]),this.currentCustomer=w(null),this.modalState=w({isOpen:!1,product:null,isEditing:!1}),this.toastMessage=w(null),this.paymentMethod=w("EFECTIVO"),this.isLoading=w(!1),this.grandTotal=z(()=>this.cart().reduce((e,t)=>e+t.total,0)),this.totalItems=z(()=>this.cart().reduce((e,t)=>e+t.quantity,0))}searchProductBySku(e){return O(this,null,function*(){this.isLoading.set(!0);try{return yield H(this.apiService.get(`pos/products?sku=${e}`))}catch(t){console.error("Error buscando producto:",t),this.showToast("Producto no encontrado");return}finally{this.isLoading.set(!1)}})}searchCustomerByDni(e){return O(this,null,function*(){this.isLoading.set(!0);try{let t=yield H(this.apiService.get(`pos/customers?dni=${e}`));return t?(this.currentCustomer.set(t),this.showToast("Cliente encontrado"),!0):!1}catch(t){return console.error("Error buscando cliente:",t),this.showToast("Cliente no encontrado / Error API"),!1}finally{this.isLoading.set(!1)}})}processCheckout(){return O(this,null,function*(){if(this.cart().length===0)return this.showToast("El carrito est\xE1 vac\xEDo");this.isLoading.set(!0);let e={customer:{id:this.currentCustomer()?.id},total:this.grandTotal(),payment_method:this.paymentMethod(),items:this.cart().map(t=>({name:t.name,quantity:t.quantity,unitPrice:t.unitPrice,total:t.total,size:t.size,color:{product_size_id:t.color.product_size_id,color_id:t.color.color_id,colorName:t.color.colorName,hex:t.color.hex,stock:t.color.stock}}))};try{let t=yield H(this.apiService.post("pos/checkout",e));t.success?(this.showToast(`Venta Registrada ID: ${t.sale_id}
Imprimiendo ticket...`),this.printTicket(t.sale_id),this.clearCart()):this.showToast("Error al procesar venta")}catch(t){this.showToast("Error: Intente nuevamente!"),console.error(t)}finally{this.isLoading.set(!1)}})}addItem(e){this.cart.update(t=>[...t,e]),this.showToast("Producto Agregado")}updateItem(e){this.cart.update(t=>t.map(i=>i.cartId===e.cartId?e:i)),this.showToast("\xCDtem Actualizado")}removeItem(e){this.cart.update(t=>t.filter(i=>i.cartId!==e))}clearCart(){this.cart.set([]),this.currentCustomer.set(null),this.paymentMethod.set("EFECTIVO")}updateQuantity(e,t){this.cart.update(i=>i.map(r=>{if(r.cartId===e){let s=r.quantity+t;return s<=0?r:s>r.color.stock?(this.showToast(`Stock m\xE1x: ${r.color.stock}`),r):Y(K({},r),{quantity:s,total:s*r.unitPrice})}return r}))}openAddModal(e){this.modalState.set({isOpen:!0,product:e,isEditing:!1})}openEditModal(e){this.searchProductBySku(e.sku).then(t=>{t&&this.modalState.set({isOpen:!0,product:t,isEditing:!0,editingCartItem:e})})}closeModal(){this.modalState.set({isOpen:!1,product:null,isEditing:!1})}showToast(e){this.toastMessage.set(e),setTimeout(()=>this.toastMessage.set(null),2500)}setPaymentMethod(e){this.paymentMethod.set(e)}printTicket(e){let i=`${this.apiService.BASE_URL.replace(/\/api\/?$/,"")}/pos/sales/${e}/ticket`,r=document.createElement("iframe");r.style.display="none",r.src=i,document.body.appendChild(r),r.onload=()=>{try{r.contentWindow?.print()}catch(s){console.error(s)}setTimeout(()=>{document.body.removeChild(r)},5e3)}}static{this.\u0275fac=function(t){return new(t||n)}}static{this.\u0275prov=oe({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})();function Ce(n,_){if(n&1){let e=S();o(0,"div",11)(1,"div",12)(2,"div",13),u(3,"i",14),a(),o(4,"div",15)(5,"div",16),l(6),a(),o(7,"div",17),l(8),a()()(),o(9,"button",18),m("click",function(){g(e);let i=p();return x(i.reset())}),u(10,"i",19),a()()}if(n&2){let e,t,i=p();c(6),b(" ",(e=i.posService.currentCustomer())==null?null:e.name," "),c(2),b(" ",(t=i.posService.currentCustomer())==null?null:t.dni," ")}}var xe=(()=>{class n{constructor(){this.posService=C(F),this.dniQuery=""}search(){this.posService.searchCustomerByDni(this.dniQuery)||(this.dniQuery="")}reset(){this.posService.currentCustomer.set(null),this.dniQuery=""}static{this.\u0275fac=function(t){return new(t||n)}}static{this.\u0275cmp=E({type:n,selectors:[["app-pos-header"]],standalone:!0,features:[I],decls:13,vars:2,consts:[[1,"bg-white","px-3","py-3","shadow-1","z-2","relative","border-bottom-1","border-gray-100","flex-shrink-0"],[1,"flex","justify-content-between","align-items-center","mb-2"],[1,"pi","pi-bars","text-xl","text-gray-500"],[1,"font-bold","text-gray-700"],[1,"w-2rem","h-2rem","border-circle","bg-gray-200","flex","align-items-center","justify-content-center"],[1,"pi","pi-user","text-gray-500"],[1,"relative","w-full"],[1,"pi","pi-user","absolute","text-gray-400","z-1",2,"top","50%","left","1rem","transform","translateY(-50%)"],["type","tel","placeholder","DNI / RUC Cliente","inputmode","numeric",1,"w-full","border-round-xl","py-3","pl-6","pr-6","border-none","bg-gray-100","font-medium","text-gray-800","focus:bg-white","focus:shadow-input","transition-all",3,"ngModelChange","keydown.enter","ngModel"],[1,"absolute","right-0","top-0","h-full","w-3rem","border-none","bg-indigo-600","border-round-right-xl","text-white","cursor-pointer","hover:bg-indigo-700",3,"click"],[1,"pi","pi-search"],[1,"mt-2","bg-indigo-50","border-1","border-indigo-100","border-round-xl","p-2","flex","justify-content-between","align-items-center","slide-down","animation-duration-200"],[1,"flex","align-items-center","gap-2","overflow-hidden"],[1,"bg-indigo-600","text-white","border-circle","w-2rem","h-2rem","flex","align-items-center","justify-content-center","flex-shrink-0"],[1,"pi","pi-check","text-xs"],[1,"overflow-hidden"],[1,"font-bold","text-indigo-900","text-sm","white-space-nowrap","overflow-hidden","text-overflow-ellipsis"],[1,"text-xs","text-indigo-500","font-medium"],[1,"bg-transparent","border-none","text-gray-400","hover:text-gray-600","cursor-pointer","p-2",3,"click"],[1,"pi","pi-times"]],template:function(t,i){t&1&&(o(0,"header",0)(1,"div",1),u(2,"i",2),o(3,"div",3),l(4,"POS"),a(),o(5,"div",4),u(6,"i",5),a()(),o(7,"div",6),u(8,"i",7),o(9,"input",8),Z("ngModelChange",function(s){return J(i.dniQuery,s)||(i.dniQuery=s),s}),m("keydown.enter",function(){return i.search()}),a(),o(10,"button",9),m("click",function(){return i.search()}),u(11,"i",10),a()(),y(12,Ce,11,2,"div",11),a()),t&2&&(c(9),X("ngModel",i.dniQuery),c(3),k(12,i.posService.currentCustomer()?12:-1))},dependencies:[P,R,A,Q,N],styles:[".shadow-input[_ngcontent-%COMP%]{box-shadow:0 0 0 4px #6366f11a}.slide-down[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_slidedown .3s cubic-bezier(.16,1,.3,1)}@keyframes _ngcontent-%COMP%_slidedown{0%{transform:translateY(-10px);opacity:0}to{transform:translateY(0);opacity:1}}"]})}}return n})();var he=(()=>{class n{constructor(){this.posService=C(F)}static{this.\u0275fac=function(t){return new(t||n)}}static{this.\u0275cmp=E({type:n,selectors:[["app-pos-footer"]],standalone:!0,features:[I],decls:24,vars:34,consts:[[1,"fixed","bottom-0","left-0","w-full","bg-white","z-4","shadow-top","border-top-1","border-gray-100","px-4","py-3","fadein-animation"],[1,"flex","gap-2","mb-3"],[1,"flex-1","border-1","border-round-xl","p-2","cursor-pointer","transition-all","flex","flex-column","align-items-center","justify-content-center","gap-1",3,"click"],[1,"pi","pi-money-bill","text-xl"],[1,"text-xs","font-bold"],[1,"pi","pi-qrcode","text-xl"],[1,"pi","pi-credit-card","text-xl"],[1,"flex","justify-content-between","align-items-center","mb-3"],[1,"text-xs","font-bold","text-gray-500","uppercase","letter-spacing-1"],[1,"text-3xl","font-black","text-gray-900"],[1,"w-full","bg-indigo-700","text-white","py-3","border-round-xl","font-bold","text-lg","shadow-3","border-none","cursor-pointer","hover:bg-indigo-800","active:scale-95","transition-all","flex","justify-content-center","align-items-center","gap-2",3,"click"],[1,"pi","pi-check-circle","text-xl"]],template:function(t,i){t&1&&(o(0,"div",0)(1,"div",1)(2,"div",2),m("click",function(){return i.posService.setPaymentMethod("EFECTIVO")}),u(3,"i",3),o(4,"span",4),l(5,"Efectivo"),a()(),o(6,"div",2),m("click",function(){return i.posService.setPaymentMethod("YAPE/PLIN")}),u(7,"i",5),o(8,"span",4),l(9,"Yape/Plin"),a()(),o(10,"div",2),m("click",function(){return i.posService.setPaymentMethod("TRANSFERENCIA")}),u(11,"i",6),o(12,"span",4),l(13,"Tarjeta"),a()()(),o(14,"div",7)(15,"span",8),l(16,"Total a Pagar"),a(),o(17,"span",9),l(18),T(19,"number"),a()(),o(20,"button",10),m("click",function(){return i.posService.processCheckout()}),u(21,"i",11),o(22,"span"),l(23,"COBRAR"),a()()()),t&2&&(c(2),v("border-indigo-600",i.posService.paymentMethod()==="EFECTIVO")("bg-indigo-50",i.posService.paymentMethod()==="EFECTIVO")("text-indigo-700",i.posService.paymentMethod()==="EFECTIVO")("border-gray-200",i.posService.paymentMethod()!=="EFECTIVO")("text-gray-500",i.posService.paymentMethod()!=="EFECTIVO"),c(4),v("border-pink-500",i.posService.paymentMethod()==="YAPE/PLIN")("bg-pink-50",i.posService.paymentMethod()==="YAPE/PLIN")("text-pink-600",i.posService.paymentMethod()==="YAPE/PLIN")("border-gray-200",i.posService.paymentMethod()!=="YAPE/PLIN")("text-gray-500",i.posService.paymentMethod()!=="YAPE/PLIN"),c(4),v("border-indigo-600",i.posService.paymentMethod()==="TRANSFERENCIA")("bg-indigo-50",i.posService.paymentMethod()==="TRANSFERENCIA")("text-indigo-700",i.posService.paymentMethod()==="TRANSFERENCIA")("border-gray-200",i.posService.paymentMethod()!=="TRANSFERENCIA")("text-gray-500",i.posService.paymentMethod()!=="TRANSFERENCIA"),c(8),b("S/ ",V(19,31,i.posService.grandTotal(),"1.2-2"),""))},dependencies:[P,j],styles:[".shadow-top[_ngcontent-%COMP%]{box-shadow:0 -4px 20px #00000014}.fadein-animation[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_fadein .3s ease-out}@keyframes _ngcontent-%COMP%_fadein{0%{opacity:0}to{opacity:1}}"]})}}return n})();var we=(n,_)=>_.color_id;function ke(n,_){if(n&1){let e=S();o(0,"div",23),m("click",function(){let i=g(e).$implicit,r=p(2);return x(r.selectTabSize(i))}),l(1),a()}if(n&2){let e=_.$implicit,t=p(2);v("border-indigo-600",t.activeSize()===e)("bg-indigo-600",t.activeSize()===e)("text-white",t.activeSize()===e)("border-gray-100",t.activeSize()!==e)("bg-white",t.activeSize()!==e)("text-gray-600",t.activeSize()!==e),c(),b(" ",e," ")}}function Pe(n,_){n&1&&(o(0,"div",12),u(1,"i",24),o(2,"span",25),l(3,"Selecciona una talla arriba"),a()())}function Me(n,_){n&1&&u(0,"i",33)}function Ee(n,_){if(n&1){let e=S();o(0,"div",37),m("click",function(i){return g(e),x(i.stopPropagation())}),o(1,"div",38)(2,"span",39),l(3,"Precio"),a(),o(4,"div",40)(5,"span",41),l(6,"S/"),a(),o(7,"input",42),m("ngModelChange",function(i){g(e);let r=p().$implicit,s=p(3);return x(s.updatePrice(r,i))})("focus",function(i){return g(e),x(i.target.select())}),a()()(),o(8,"div",38)(9,"span",39),l(10,"Cant."),a(),o(11,"div",43)(12,"button",44),m("click",function(i){g(e);let r=p().$implicit,s=p(3);return x(s.updateQty(s.activeSize(),r,-1,i))}),l(13," - "),a(),o(14,"span",45),l(15),a(),o(16,"button",46),m("click",function(i){g(e);let r=p().$implicit,s=p(3);return x(s.updateQty(s.activeSize(),r,1,i))}),l(17," + "),a()()()()}if(n&2){let e=p().$implicit,t=p(3);c(7),$("ngModel",t.getSelectionPrice(e)),c(8),M(t.getSelectionQty(e))}}function Ie(n,_){if(n&1&&(o(0,"div",47)(1,"span",48),l(2),T(3,"number"),a(),o(4,"span",49),l(5,"Toca para agregar"),a()()),n&2){let e=p().$implicit;c(2),b("S/ ",V(3,1,e.price,"1.2-2"),"")}}function Te(n,_){if(n&1){let e=S();o(0,"div",30),m("click",function(){let i=g(e).$implicit,r=p(3);return x(i.stock>0&&r.getSelectionQty(i)===0?r.toggleVariant(i):null)}),o(1,"div",31)(2,"div",32),y(3,Me,1,0,"i",33),a(),o(4,"div",15)(5,"span",34),l(6),a(),o(7,"span",35),l(8),a()()(),y(9,Ee,18,2,"div",36)(10,Ie,6,4),a()}if(n&2){let e=_.$implicit,t=p(3);v("border-indigo-500",t.getSelectionQty(e)>0)("bg-indigo-50",t.getSelectionQty(e)>0)("border-white",t.getSelectionQty(e)===0)("opacity-50",e.stock<=0),c(2),G("background-color",e.hex),v("border-gray-200",e.hex==="#ffffff")("border-transparent",e.hex!=="#ffffff"),c(),k(3,t.getSelectionQty(e)>0?3:-1),c(3),M(e.colorName),c(),v("text-green-600",e.stock>5)("text-red-500",e.stock<=5),c(),b(" Stock: ",e.stock," "),c(),k(9,t.getSelectionQty(e)>0?9:10)}}function Ve(n,_){if(n&1&&(o(0,"div",26)(1,"span",27),l(2),a()(),o(3,"div",28),D(4,Te,11,22,"div",29,we),a()),n&2){let e=p(2);c(2),b("2. Selecciona Variantes (",e.activeSize(),")"),c(2),L(e.currentSizeVariants())}}function ze(n,_){if(n&1){let e=S();o(0,"div",0)(1,"div",1)(2,"div",2)(3,"button",3),m("click",function(){g(e);let i=p();return x(i.posService.closeModal())}),u(4,"i",4),a(),o(5,"div",5)(6,"h2",6),l(7),a(),o(8,"p",7),l(9),a()(),o(10,"div")(11,"span",8),l(12,"1. Selecciona Talla"),a(),o(13,"div",9),D(14,ke,2,13,"div",10,re),a()()(),o(16,"div",11),y(17,Pe,4,0,"div",12)(18,Ve,6,1),a(),o(19,"div",13)(20,"div",14)(21,"div",15)(22,"span",16),l(23,"Resumen"),a(),o(24,"span",17)(25,"strong",18),l(26),a(),l(27," prendas "),a()(),o(28,"div",19)(29,"span",16),l(30,"Total Estimado"),a(),o(31,"div",20),l(32),T(33,"number"),a()()(),o(34,"button",21),m("click",function(){g(e);let i=p();return x(i.confirm())}),u(35,"i",22),o(36,"span"),l(37),a()()()()()}if(n&2){let e,t,i=p();c(7),b(" ",(e=i.posService.modalState().product)==null?null:e.name," "),c(2),b(" SKU: ",(t=i.posService.modalState().product)==null?null:t.sku," "),c(5),L(i.availableSizes()),c(3),k(17,i.activeSize()?18:17),c(9),M(i.totalModalItems()),c(6),b(" S/ ",V(33,7,i.totalModalPrice(),"1.2-2")," "),c(2),$("disabled",i.totalModalItems()===0),c(3),M(i.posService.modalState().isEditing?"GUARDAR CAMBIOS":"AGREGAR AL CARRITO")}}var be=(()=>{class n{constructor(){this.posService=C(F),this.activeSize=w(null),this.selections=w(new Map),this.availableSizes=z(()=>{let e=this.posService.modalState().product;return e?Object.keys(e.variants):[]}),this.currentSizeVariants=z(()=>{let e=this.posService.modalState().product,t=this.activeSize();return!e||!t?[]:e.variants[t]||[]}),this.totalModalItems=z(()=>{let e=0;for(let t of this.selections().values())e+=t.qty;return e}),this.totalModalPrice=z(()=>{let e=0;for(let t of this.selections().values())e+=t.qty*t.price;return e}),pe(()=>{let e=this.posService.modalState();de(()=>{if(e.isOpen&&e.product){let t=new Map;if(this.activeSize.set(null),this.posService.cart().filter(s=>s.productId===e.product.id).forEach(s=>{let h=(e.product.variants[s.size]||[]).find(f=>String(f.color_id)===String(s.color.color_id));if(h){let f=this.getItemKey(s.size,h.color_id);t.set(f,{variant:h,size:s.size,qty:s.quantity,price:s.unitPrice})}}),this.selections.set(t),e.isEditing&&e.editingCartItem)this.activeSize.set(e.editingCartItem.size);else{let s=e.product.sku,d=null,h=null;for(let f in e.product.variants){let te=e.product.variants[f].find(Se=>Se.sku===s);if(te){d=f,h=te;break}}if(d&&h){this.activeSize.set(d);let f=this.getItemKey(d,h.color_id);if(t.has(f)){let B=t.get(f);B.qty<h.stock&&(B.qty++,t.set(f,B),this.selections.set(new Map(t)))}else this.addSelection(d,h,1,h.price)}else{let f=Object.keys(e.product.variants);f.length>0&&this.activeSize.set(f[0])}}}})},{allowSignalWrites:!0})}getItemKey(e,t){return`${e}_${String(t)}`}selectTabSize(e){this.activeSize.set(e)}toggleVariant(e){let t=this.activeSize();if(!t||e.stock<=0)return;let i=this.getItemKey(t,e.color_id),r=new Map(this.selections());if(r.has(i)){let s=r.get(i);s.qty<e.stock&&(s.qty++,r.set(i,s))}else r.set(i,{variant:e,size:t,qty:1,price:e.price});this.selections.set(r)}addSelection(e,t,i,r){let s=this.getItemKey(e,t.color_id),d=new Map(this.selections());d.set(s,{variant:t,size:e,qty:i,price:r}),this.selections.set(d)}updateQty(e,t,i,r){r&&r.stopPropagation();let s=this.getItemKey(e,t.color_id),d=new Map(this.selections());if(!d.has(s)){i>0&&this.toggleVariant(t);return}let h=d.get(s),f=h.qty+i;f<=0?d.delete(s):f<=t.stock&&(h.qty=f,d.set(s,h)),this.selections.set(d)}updatePrice(e,t){let i=this.activeSize();if(!i)return;let r=this.getItemKey(i,e.color_id),s=new Map(this.selections());if(s.has(r)){let d=s.get(r);d.price=t,s.set(r,d),this.selections.set(s)}}getSelectionQty(e){let t=this.activeSize();if(!t)return 0;let i=this.getItemKey(t,e.color_id);return this.selections().get(i)?.qty||0}getSelectionPrice(e){let t=this.activeSize();if(!t)return e.price;let i=this.getItemKey(t,e.color_id);return this.selections().get(i)?.price||e.price}confirm(){let e=this.posService.modalState();if(!e.product)return;let t=this.selections(),r=this.posService.cart().filter(d=>d.productId===e.product.id),s=new Set;for(let d of t.values()){let h=r.find(f=>f.size===d.size&&String(f.color.color_id)===String(d.variant.color_id));if(h){let f=Y(K({},h),{quantity:d.qty,unitPrice:d.price,total:d.qty*d.price,color:d.variant});this.posService.updateItem(f),s.add(h.cartId)}else{let f={cartId:Date.now()+Math.random(),productId:e.product.id,sku:e.product.sku,name:e.product.name,size:d.size,color:d.variant,quantity:d.qty,unitPrice:d.price,total:d.qty*d.price};this.posService.addItem(f)}}for(let d of r)s.has(d.cartId)||this.posService.removeItem(d.cartId);this.posService.closeModal()}static{this.\u0275fac=function(t){return new(t||n)}}static{this.\u0275cmp=E({type:n,selectors:[["app-pos-selector"]],standalone:!0,features:[I],decls:1,vars:1,consts:[[1,"fixed","top-0","left-0","w-full","h-full","z-6","flex","align-items-end","sm:align-items-center","justify-content-center","glass-overlay","fadein-animation"],[1,"bg-white","w-full","sm:w-30rem","border-round-top-2xl","sm:border-round-2xl","p-0","shadow-6","slide-up","max-h-screen","overflow-hidden","relative","flex","flex-column","h-[85vh]","sm:h-auto"],[1,"p-4","pb-2","bg-white","z-20","border-bottom-1","border-gray-100","relative"],[1,"absolute","top-0","right-0","m-4","bg-transparent","border-none","text-gray-400","hover:text-gray-600","cursor-pointer","p-2","z-30",3,"click"],[1,"pi","pi-times","text-xl"],[1,"pr-5","mb-3"],[1,"text-xl","font-bold","text-gray-900","m-0","line-height-2"],[1,"text-gray-500","text-sm","font-mono","m-0","mt-1"],[1,"text-xs","font-bold","text-gray-400","uppercase","block","mb-2"],[1,"flex","gap-2","overflow-x-auto","pb-2","scrollbar-hide"],[1,"px-4","py-3","border-1","border-round-xl","cursor-pointer","transition-all","font-bold","text-sm","min-w-3rem","text-center","select-none","shadow-1","flex-shrink-0","relative",3,"border-indigo-600","bg-indigo-600","text-white","border-gray-100","bg-white","text-gray-600"],[1,"flex-1","overflow-y-auto","p-4","bg-gray-50"],[1,"flex","flex-column","align-items-center","justify-content-center","h-full","text-gray-400","opacity-60"],[1,"p-4","border-top-1","border-gray-200","bg-white","z-20","shadow-up-2"],[1,"flex","justify-content-between","align-items-center","mb-3"],[1,"flex","flex-column"],[1,"text-xs","font-bold","text-gray-500","uppercase"],[1,"text-sm","font-medium","text-gray-900"],[1,"text-indigo-600","text-lg"],[1,"text-right"],[1,"font-black","text-xl","text-gray-900"],[1,"w-full","font-bold","py-3","bg-gray-900","text-white","border-round-xl","shadow-3","border-none","cursor-pointer","hover:bg-black","transition-all","disabled:opacity-50","text-lg","flex","align-items-center","justify-content-center","gap-2",3,"click","disabled"],[1,"pi","pi-check"],[1,"px-4","py-3","border-1","border-round-xl","cursor-pointer","transition-all","font-bold","text-sm","min-w-3rem","text-center","select-none","shadow-1","flex-shrink-0","relative",3,"click"],[1,"pi","pi-arrow-up","text-4xl","mb-2"],[1,"font-bold","text-sm"],[1,"flex","justify-content-between","mb-2","px-1"],[1,"text-xs","font-bold","text-gray-400","uppercase"],[1,"flex","flex-column","gap-3"],[1,"bg-white","p-3","border-round-2xl","shadow-1","flex","flex-column","sm:flex-row","sm:align-items-center","gap-3","transition-all","border-1",3,"border-indigo-500","bg-indigo-50","border-white","opacity-50"],[1,"bg-white","p-3","border-round-2xl","shadow-1","flex","flex-column","sm:flex-row","sm:align-items-center","gap-3","transition-all","border-1",3,"click"],[1,"flex","align-items-center","gap-3","flex-1"],[1,"w-3rem","h-3rem","border-circle","border-1","shadow-1","relative","flex","align-items-center","justify-content-center","flex-shrink-0"],[1,"pi","pi-check","text-white","text-xl","shadow-2","border-circle","p-1","bg-black-alpha-20"],[1,"font-bold","text-gray-800","text-sm","capitalize"],[1,"text-xs"],[1,"flex","align-items-center","gap-3","justify-content-between","sm:justify-content-end","w-full","sm:w-auto","mt-2","sm:mt-0","pt-2","sm:pt-0","border-top-1","sm:border-top-none","border-gray-200","sm:border-none"],[1,"flex","align-items-center","gap-3","justify-content-between","sm:justify-content-end","w-full","sm:w-auto","mt-2","sm:mt-0","pt-2","sm:pt-0","border-top-1","sm:border-top-none","border-gray-200","sm:border-none",3,"click"],[1,"flex","flex-column","align-items-center"],[1,"text-xs","text-gray-500","font-bold","uppercase","mb-1"],[1,"relative","w-5rem"],[1,"absolute","left-0","top-custom","translate-y-50","ml-2","text-gray-500","text-xs","font-bold"],["type","number",1,"w-full","border-1","border-gray-200","border-round-lg","py-2","pl-4","pr-1","text-right","font-bold","text-indigo-700","bg-white","focus:border-indigo-500","outline-none","text-sm","h-custom","shadow-1",3,"ngModelChange","focus","ngModel"],[1,"flex","align-items-center","bg-white","border-round-lg","shadow-1","h-2.2rem","border-1","border-gray-200"],[1,"border-none","bg-transparent","w-2rem","h-full","text-indigo-600","font-bold","hover:bg-gray-100","border-round-left-lg","cursor-pointer","text-lg",3,"click"],[1,"font-bold","text-base","w-1.5rem","text-center","text-gray-900"],[1,"border-none","bg-transparent","w-2rem","h-full","text-indigo-600","font-bold","hover:bg-gray-100","border-round-right-lg","cursor-pointer","text-lg",3,"click"],[1,"text-right","hidden","sm:block"],[1,"font-bold","text-gray-400","text-sm","block"],[1,"text-xs","text-indigo-500","font-bold"]],template:function(t,i){t&1&&y(0,ze,38,10,"div",0),t&2&&k(0,i.posService.modalState().isOpen?0:-1)},dependencies:[P,j,R,A,fe,Q,N],styles:[".glass-overlay[_ngcontent-%COMP%]{background:#0009;-webkit-backdrop-filter:blur(4px);backdrop-filter:blur(4px)}.fadein-animation[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_fadein .2s ease-out}.slide-up[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_slideup .3s cubic-bezier(.16,1,.3,1)}@keyframes _ngcontent-%COMP%_fadein{0%{opacity:0}to{opacity:1}}@keyframes _ngcontent-%COMP%_slideup{0%{transform:translateY(100%);opacity:0}to{transform:translateY(0);opacity:1}}.h-custom[_ngcontent-%COMP%]{height:22px}.top-custom[_ngcontent-%COMP%]{top:20%}"]})}}return n})();var Fe=["barcodeInput"],Oe=(n,_)=>_.cartId;function je(n,_){if(n&1&&(o(0,"div",3),u(1,"i",15),o(2,"span",16),l(3),a()()),n&2){let e=p();c(3),M(e.posService.toastMessage())}}function Ae(n,_){if(n&1){let e=S();o(0,"span",17),m("click",function(){g(e);let i=p();return x(i.posService.clearCart())}),l(1,"Vaciar"),a()}}function Qe(n,_){n&1&&(o(0,"div",12),u(1,"i",18),o(2,"span",19),l(3,"Empieza a escanear"),a()())}function Ne(n,_){if(n&1){let e=S();o(0,"div",21),u(1,"div",22),o(2,"div",23)(3,"div",24)(4,"span",25),l(5),a(),o(6,"i",26),m("click",function(){let i=g(e).$implicit,r=p(2);return x(r.posService.removeItem(i.cartId))}),a()(),o(7,"div",27)(8,"div",28),m("click",function(){let i=g(e).$implicit,r=p(2);return x(r.posService.openEditModal(i))}),o(9,"span",29),l(10),a(),u(11,"i",30),a(),o(12,"span",31),m("click",function(){let i=g(e).$implicit,r=p(2);return x(r.posService.openEditModal(i))}),l(13),T(14,"number"),a()(),o(15,"div",32)(16,"div",33)(17,"button",34),m("click",function(){let i=g(e).$implicit,r=p(2);return x(r.posService.updateQuantity(i.cartId,-1))}),l(18," - "),a(),o(19,"span",35),l(20),a(),o(21,"button",36),m("click",function(){let i=g(e).$implicit,r=p(2);return x(r.posService.updateQuantity(i.cartId,1))}),l(22," + "),a()(),o(23,"span",37),l(24),T(25,"number"),a()()()()}if(n&2){let e=_.$implicit;c(),G("background-color",e.color.hex),v("border-1",e.color.hex==="#ffffff")("border-gray-200",e.color.hex==="#ffffff"),c(4),M(e.name),c(5),ce("",e.size," \u2022 ",e.color.colorName,""),c(3),b(" S/ ",V(14,12,e.unitPrice,"1.2-2")," "),c(7),M(e.quantity),c(4),b("Total: S/ ",V(25,15,e.total,"1.2-2"),"")}}function Re(n,_){if(n&1&&(o(0,"div",20),D(1,Ne,26,18,"div",21,Oe),a()),n&2){let e=p();c(),L(e.posService.cart())}}var ye=(()=>{class n{constructor(){this.posService=C(F),this.barcodeQuery="",this.barcodeSubject=new ie}ngOnInit(){this.barcodeSubscription=this.barcodeSubject.pipe(ne(300)).subscribe(e=>{e&&this.onScan()})}onScan(){return O(this,null,function*(){let e=this.barcodeQuery.trim();if(!e)return;let t=yield this.posService.searchProductBySku(e);t?(this.posService.openAddModal(t),this.barcodeQuery=""):this.barcodeQuery=""})}onQueryChange(e){this.barcodeSubject.next(e)}ngAfterViewChecked(){!this.posService.modalState().isOpen&&this.barcodeInput}ngOnDestroy(){this.barcodeSubscription&&this.barcodeSubscription.unsubscribe()}static{this.\u0275fac=function(t){return new(t||n)}}static{this.\u0275cmp=E({type:n,selectors:[["app-pos"]],viewQuery:function(t,i){if(t&1&&ae(Fe,5),t&2){let r;se(r=le())&&(i.barcodeInput=r.first)}},standalone:!0,features:[I],decls:18,vars:5,consts:[["mainScroll",""],["barcodeInput",""],[1,"flex","flex-column","h-screen","bg-ground","font-family","overflow-hidden","relative","bg-white","rounded-xl"],[1,"fixed","top-0","left-50","border-round-2xl","mt-4","px-4","py-3","shadow-6","z-5","bg-gray-900","text-white","flex","align-items-center","gap-2","fadein-animation",2,"transform","translateX(-50%)"],[1,"flex-1","overflow-y-auto","p-3","pb-8",2,"padding-bottom","140px !important"],[1,"mb-4","bg-white","border-round-xl","shadow-1","overflow-hidden","flex","align-items-center","border-1","border-gray-100"],["type","text","placeholder","Escanear c\xF3digo...","autofocus","",1,"flex-1","py-3","px-3","text-lg","font-mono","border-none","outline-none","text-gray-800","placeholder-gray-400",3,"ngModelChange","ngModel"],[1,"bg-gray-100","text-gray-600","border-none","px-4","py-3","cursor-pointer","hover:bg-gray-200","border-left-1","border-gray-200",3,"click"],[1,"pi","pi-barcode","text-xl"],[1,"flex","justify-content-between","align-items-end","mb-3","px-1","border-bottom-1","border-gray-200","pb-2"],[1,"text-xs","font-bold","text-gray-500","uppercase","tracking-widest"],["class","text-xs font-bold text-red-500 cursor-pointer hover:text-red-700 uppercase",3,"click",4,"ngIf"],[1,"flex","flex-column","align-items-center","justify-content-center","py-8","opacity-40","text-gray-400"],[1,"z-2"],[1,"z-3"],[1,"pi","pi-info-circle","text-lg"],[1,"font-bold","text-sm"],[1,"text-xs","font-bold","text-red-500","cursor-pointer","hover:text-red-700","uppercase",3,"click"],[1,"pi","pi-shopping-bag","text-6xl","mb-3","text-gray-300"],[1,"text-sm","font-medium"],[1,"flex","flex-column","gap-3"],[1,"bg-white","p-3","border-round-2xl","shadow-1","flex","gap-3","relative","overflow-hidden","fadein-animation","border-1","border-gray-50","item-card"],[1,"w-3rem","h-3rem","border-circle","shadow-1","flex-shrink-0","mt-1"],[1,"flex-1","min-w-0"],[1,"flex","justify-content-between","align-items-start","mb-1"],[1,"font-bold","text-gray-900","text-sm","line-height-2","block","pr-2"],[1,"pi","pi-trash","text-red-300","hover:text-red-500","cursor-pointer","p-1",3,"click"],[1,"flex","align-items-center","flex-wrap","gap-2"],[1,"bg-gray-50","border-1","border-gray-200","border-round-lg","px-2","py-1","flex","align-items-center","gap-1","cursor-pointer","hover:bg-gray-100","transition-colors",3,"click"],[1,"text-xs","font-bold","text-gray-600","uppercase"],[1,"pi","pi-pencil","text-xs","text-indigo-400","ml-1"],[1,"ml-auto","font-bold","text-indigo-600","text-sm","cursor-pointer","border-bottom-1","border-indigo-300",3,"click"],[1,"flex","justify-content-between","align-items-center","mt-3","pt-2","border-top-1","border-gray-100"],[1,"flex","align-items-center","bg-gray-50","border-round-lg","border-1","border-gray-200","h-2rem","shadow-none"],[1,"border-none","bg-transparent","px-3","h-full","text-gray-500","font-bold","hover:bg-gray-200","border-round-left-lg","cursor-pointer",3,"click"],[1,"font-bold","text-sm","w-2rem","text-center"],[1,"border-none","bg-transparent","px-3","h-full","text-indigo-600","font-bold","hover:bg-indigo-50","border-round-right-lg","cursor-pointer",3,"click"],[1,"font-bold","text-sm","text-gray-800"]],template:function(t,i){if(t&1){let r=S();o(0,"div",2),y(1,je,4,1,"div",3),u(2,"app-pos-header"),o(3,"main",4,0)(5,"div",5)(6,"input",6,1),Z("ngModelChange",function(d){return g(r),J(i.barcodeQuery,d)||(i.barcodeQuery=d),x(d)}),m("ngModelChange",function(d){return g(r),x(i.onQueryChange(d))}),a(),o(8,"button",7),m("click",function(){return g(r),x(i.onScan())}),u(9,"i",8),a()(),o(10,"div",9)(11,"span",10),l(12),a(),y(13,Ae,2,0,"span",11),a(),y(14,Qe,4,0,"div",12)(15,Re,3,0),a(),u(16,"app-pos-footer",13)(17,"app-pos-selector",14),a()}t&2&&(c(),k(1,i.posService.toastMessage()?1:-1),c(5),X("ngModel",i.barcodeQuery),c(6),b("Carrito (",i.posService.totalItems(),")"),c(),$("ngIf",i.posService.cart().length>0),c(),k(14,i.posService.cart().length===0?14:15))},dependencies:[P,me,j,R,A,Q,N,xe,he,be],styles:[".fadein-animation[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_fadein .3s ease-out}@keyframes _ngcontent-%COMP%_fadein{0%{opacity:0}to{opacity:1}}.item-card[_ngcontent-%COMP%]{transition:transform .1s}.item-card[_ngcontent-%COMP%]:active{transform:scale(.98)}main[_ngcontent-%COMP%]::-webkit-scrollbar{width:0px;background:transparent}"]})}}return n})();var qe=[{path:"",component:ye},{path:"",pathMatch:"full",redirectTo:"sales/pos"}],ve=(()=>{class n{static{this.\u0275fac=function(t){return new(t||n)}}static{this.\u0275mod=U({type:n})}static{this.\u0275inj=W({imports:[ee.forChild(qe),ee]})}}return n})();var Et=(()=>{class n{static{this.\u0275fac=function(t){return new(t||n)}}static{this.\u0275mod=U({type:n})}static{this.\u0275inj=W({imports:[P,ve]})}}return n})();export{Et as PosModule};
