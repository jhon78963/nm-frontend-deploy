import{a as be,b as ve}from"./chunk-DEZTDU5I.js";import{a as te,b as ie,c as M}from"./chunk-FTM6AZP4.js";import{B as E,a as me,l as pe,m as j,n as de,o as ue,p as fe,s as he,z as ge}from"./chunk-OTKL6CSN.js";import"./chunk-PKPWRCW7.js";import"./chunk-7QZVAUUM.js";import"./chunk-IKHQUVIJ.js";import{d as le,e as ce}from"./chunk-UXKUMFFU.js";import{d as ee}from"./chunk-SU5FXICQ.js";import{d as se,e as I}from"./chunk-JLFYD4SE.js";import"./chunk-3JYME56N.js";import"./chunk-CPF55P7Y.js";import{g as y,k as C}from"./chunk-KJUOHDYT.js";import{d as f,g as _,h as oe,j as re,l as ae,o as D,t as ne,u as F,v as w}from"./chunk-CR7W443G.js";import{Aa as $,Ab as T,B as v,C as S,H as J,I as K,Ra as X,Sa as Y,Tb as O,Ua as k,V as d,W as a,cb as B,d as A,db as V,fa as Q,g as P,ha as c,l as z,na as U,q as h,r as g,sa as m,ta as n,ua as l,v as q,w as b,xb as Z,y as H,ya as W,za as u}from"./chunk-DIPV63T5.js";var G=class{constructor(p){this.id=p.id,this.dni=p.dni,this.name=p.name,this.surname=p.surname,this.salary=p.salary}};var L=(()=>{class i{constructor(e){this.apiService=e,this.team=[],this.total=0,this.team$=new P(this.team),this.total$=new P(this.total)}callGetList(e=10,t=1,o=""){let r=`teams?limit=${e}&page=${t}`;return o&&(r+=`&search=${o}`),this.apiService.get(r).pipe(h(600),z(s=>{this.updateTeam(s.data),this.updateTotalTeam(s.paginate.total)}))}getList(){return this.team$.asObservable()}getTotal(){return this.total$.asObservable()}getOne(e){return this.apiService.get(`teams/${e}`)}create(e){return this.apiService.post("teams",e).pipe(g(()=>this.callGetList()))}edit(e,t){return this.apiService.patch(`teams/${e}`,t).pipe(g(()=>this.callGetList()))}delete(e){return this.apiService.delete(`teams/${e}`).pipe(g(()=>this.callGetList()))}updateTeam(e){this.team=e,this.team$.next(this.team)}updateTotalTeam(e){this.total=e,this.total$.next(this.total)}static{this.\u0275fac=function(t){return new(t||i)(H(ee))}}static{this.\u0275prov=q({token:i,factory:i.\u0275fac,providedIn:"root"})}}return i})();function Fe(i,p){if(i&1){let e=W();m(0,"form",1),u("ngSubmit",function(){J(e);let o=$();return K(o.buttonSaveTeam())}),m(1,"div",2)(2,"div",3),l(3,"app-input-text",4),n(),m(4,"div",3),l(5,"app-input-text",5),n(),m(6,"div",3),l(7,"app-input-text",6),n(),m(8,"div",3),l(9,"app-input-text",7),n(),l(10,"button",8),n()()}if(i&2){let e=$();c("formGroup",e.form),d(10),c("disabled",!e.isValid)}}var R=(()=>{class i{constructor(e,t,o,r){this.formBuilder=e,this.teamService=t,this.dynamicDialogRef=o,this.dynamicDialogConfig=r,this.form=this.formBuilder.group({dni:["",f.required],name:["",f.required],surname:["",f.required],salary:["",f.nullValidator]})}ngOnInit(){if(this.dynamicDialogConfig.data.id){let e=this.dynamicDialogConfig.data.id;this.teamService.getOne(e).subscribe(t=>{this.form.patchValue(t)})}}get isValid(){return this.form.valid}buttonSaveTeam(){if(this.form){let e=new G(this.form.value);if(this.dynamicDialogConfig.data.id){let t=this.dynamicDialogConfig.data.id;this.teamService.edit(t,e).subscribe({next:()=>this.dynamicDialogRef.close(),error:()=>{}})}else this.teamService.create(e).subscribe({next:()=>{this.dynamicDialogRef.close({success:!0}),this.form.reset()},error:()=>{}})}}static{this.\u0275fac=function(t){return new(t||i)(a(ne),a(L),a(ie),a(te))}}static{this.\u0275cmp=v({type:i,selectors:[["app-team-form"]],decls:1,vars:1,consts:[[3,"formGroup"],[3,"ngSubmit","formGroup"],[1,"p-fluid","p-formgrid","grid"],[1,"col-12"],["placeholder","Ingrese nombres","label","Dni","controlName","dni"],["placeholder","Ingrese nombres","label","Nombres","controlName","name"],["placeholder","Ingrese apellidos","label","Apellidos","controlName","surname"],["placeholder","Ingrese salario","label","Salario","controlName","salary"],["type","submit","pButton","","label","Guardar",1,"mt-3",3,"disabled"]],template:function(t,o){t&1&&Q(0,Fe,11,2,"form",0),t&2&&U(0,o.form?0:-1)},dependencies:[le,ae,_,me,D]})}}return i})();var we=()=>[],Ie=()=>[10,20,50],Te=(()=>{class i{constructor(e,t,o,r,s){this.dialogService=e,this.teamService=t,this.messageService=o,this.confirmationService=r,this.loadingService=s,this.columns=[],this.data=[],this.limit=10,this.page=1,this.name="",this.callToAction=[{type:"button",size:"small",icon:"pi pi-pencil",outlined:!0,pTooltip:"Editar",tooltipPosition:"bottom",click:N=>this.buttonEditTeam(N.id)},{type:"button",size:"small",icon:"pi pi-trash",outlined:!0,pTooltip:"Eliminar",tooltipPosition:"bottom",click:(N,Ce)=>this.buttonDeleteTeam(N.id,Ce)}],this.formGroup=new oe({search:new re(null)})}ngOnInit(){this.columns=[{header:"#",field:"id",clickable:!1,image:!1,money:!1},{header:"Nombres",field:"name",clickable:!1,image:!1,money:!1},{header:"Apellidos",field:"surname",clickable:!1,image:!1,money:!1},{header:"Salario",field:"salary",clickable:!1,image:!1,money:!1},{field:"button",header:"Acci\xF3n",clickable:!1,image:!1,money:!1}],this.getTeam(this.limit,this.page,this.name),this.formGroup.get("search")?.valueChanges.pipe(h(600)).subscribe(e=>{this.name=e||"",this.loadingService.sendLoadingState(!0),this.getTeam(this.limit,this.page,this.name)})}ngOnDestroy(){this.teamModal&&this.teamModal.close()}clearFilter(){this.name="",this.loadingService.sendLoadingState(!0),this.formGroup.get("search")?.setValue("")}updatePage(e){this.page=e}getTeam(){return A(this,arguments,function*(e=this.limit,t=this.page,o=this.name){this.updatePage(t),this.teamService.callGetList(e,t,o).subscribe(),setTimeout(()=>{this.loadingService.sendLoadingState(!1)},600)})}get team(){return this.teamService.getList()}get total(){return this.teamService.getTotal()}onPageSelected(e){return A(this,null,function*(){this.updatePage((e.page??0)+1),this.getTeam(e.rows,this.page)})}buttonAddTeam(){this.teamModal=this.dialogService.open(R,{data:{},header:"Crear"}),this.teamModal.onClose.subscribe({next:e=>{e&&e?.success?this.showSuccess("Colaborador Creado."):e?.error&&this.showError(e?.error)}})}buttonEditTeam(e){this.teamModal=this.dialogService.open(R,{data:{id:e},header:"Editar"}),this.teamModal.onClose.subscribe({next:t=>{t&&t?.success?this.showSuccess("Colaborador actualizado."):t?.error&&this.showError(t?.error)}})}buttonDeleteTeam(e,t){this.confirmationService.confirm({target:t.target,message:"Deseas eliminar este colaborador?",header:"Eliminar colaborador",icon:"pi pi-info-circle",acceptButtonStyleClass:"p-button-danger p-button-text",rejectButtonStyleClass:"p-button-text p-button-text",acceptIcon:"none",rejectIcon:"none",acceptLabel:"Si",rejectLabel:"No",accept:()=>{this.teamService.delete(e).subscribe(()=>{this.showSuccess("El rol ha sido eliminado")})},reject:()=>{}})}showSuccess(e){this.messageService.add({severity:"success",summary:"Confirmado",detail:e,life:3e3})}showError(e){this.messageService.add({severity:"error",summary:"Error",detail:e,life:3e3})}static{this.\u0275fac=function(t){return new(t||i)(a(M),a(L),a(C),a(y),a(ue))}}static{this.\u0275cmp=v({type:i,selectors:[["app-team"]],standalone:!0,features:[X([y,C]),Y],decls:10,vars:15,consts:[[1,"card"],[1,"flex","justify-content-between","align-items-center","mt-3","gap-3"],["controlName","search",1,"w-full","md:w-3",3,"clearFilter","formGroup"],[3,"click","outlined"],[1,"pi","pi-plus",2,"font-size","1rem"],[3,"paginateSelected","data","columns","callToAction","cellToAction","total","limit","rowsPerPageOptions"]],template:function(t,o){if(t&1&&(m(0,"div",0)(1,"div",1)(2,"app-input-search",2),u("clearFilter",function(){return o.clearFilter()}),n(),m(3,"p-button",3),u("click",function(){return o.buttonAddTeam()}),l(4,"i",4),n()(),m(5,"app-table-pagination",5),B(6,"async"),B(7,"async"),u("paginateSelected",function(s){return o.onPageSelected(s)}),n(),l(8,"p-toast")(9,"p-confirmDialog"),n()),t&2){let r,s;d(2),c("formGroup",o.formGroup),d(),c("outlined",!0),d(2),c("data",(r=V(6,9,o.team))!==null&&r!==void 0?r:k(13,we))("columns",o.columns)("callToAction",o.callToAction)("cellToAction",o.cellToAction)("total",(s=V(7,11,o.total))!==null&&s!==void 0?s:0)("limit",o.limit)("rowsPerPageOptions",k(14,Ie))}},dependencies:[T,Z,F,_,w,D,j,pe,ce,I,se,E,fe,ge]})}}return i})();var je=[{path:"",component:Te},{path:"",pathMatch:"full",redirectTo:"roles"}],ye=(()=>{class i{static{this.\u0275fac=function(t){return new(t||i)}}static{this.\u0275mod=S({type:i})}static{this.\u0275inj=b({imports:[O.forChild(je),O]})}}return i})();var gt=(()=>{class i{static{this.\u0275fac=function(t){return new(t||i)}}static{this.\u0275mod=S({type:i})}static{this.\u0275inj=b({providers:[M],imports:[T,ye,E,F,w,I,j,be,ve,de,he]})}}return i})();export{gt as TeamModule};
