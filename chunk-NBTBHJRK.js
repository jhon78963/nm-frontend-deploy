import{a as _e}from"./chunk-7JNPHJRQ.js";import{a as ve,b as ye}from"./chunk-TCQXBJHA.js";import{m as he,p as be}from"./chunk-Y5QMDDSO.js";import"./chunk-ZRB5JYID.js";import"./chunk-DECUXDPT.js";import"./chunk-FTJNOPBC.js";import{d as oe}from"./chunk-NELNUKEX.js";import{d as ge,f as xe}from"./chunk-53BCAK53.js";import{b as fe}from"./chunk-MROZGMZP.js";import"./chunk-S23T3VNK.js";import"./chunk-ZSZR532A.js";import{b as re,f as le,g as se,i as me,k as de,l as ce,m as pe,w as ue}from"./chunk-3IAGLYRS.js";import{k as W,p as ae}from"./chunk-56NTXRTG.js";import{m as A}from"./chunk-DIBFAAWP.js";import{Ab as f,Bb as c,Hb as J,Ib as K,Jb as X,Lb as a,Lc as w,Mb as k,Nb as p,Nc as ee,Ob as P,Oc as te,Pb as V,Pc as ie,Qb as D,Ra as l,Rb as j,S as Q,Sb as Z,Sc as z,T as _,Tb as L,Tc as ne,Uc as b,Wb as $,X as U,Xb as B,Y as E,a as O,ab as I,b as H,ba as C,ca as S,dc as x,fc as h,gb as g,hb as q,ib as m,ka as Y,la as v,ma as y,mb as N,ob as T,tb as i,ub as n,va as R,vb as d,zb as G}from"./chunk-UISEBZIM.js";var Ce=(()=>{class e{constructor(t){this.apiService=t}getSummary(){return this.apiService.get("financial/summary")}static{this.\u0275fac=function(o){return new(o||e)(U(oe))}}static{this.\u0275prov=Q({token:e,factory:e.\u0275fac,providedIn:"root"})}}return e})();var we=(()=>{class e{styleClass;style;shape="rectangle";animation="wave";borderRadius;size;width="100%";height="1rem";containerClass(){return{"p-skeleton p-component":!0,"p-skeleton-circle":this.shape==="circle","p-skeleton-none":this.animation==="none"}}get containerStyle(){return this.size?H(O({},this.style),{width:this.size,height:this.size,borderRadius:this.borderRadius}):O({width:this.width,height:this.height,borderRadius:this.borderRadius},this.style)}static \u0275fac=function(o){return new(o||e)};static \u0275cmp=C({type:e,selectors:[["p-skeleton"]],hostAttrs:[1,"p-element"],inputs:{styleClass:"styleClass",style:"style",shape:"shape",animation:"animation",borderRadius:"borderRadius",size:"size",width:"width",height:"height"},decls:1,vars:7,consts:[[3,"ngClass","ngStyle"]],template:function(o,r){o&1&&d(0,"div",0),o&2&&(N(r.styleClass),m("ngClass",r.containerClass())("ngStyle",r.containerStyle),q("data-pc-name","skeleton")("aria-hidden",!0)("data-pc-section","root"))},dependencies:[w,ie],styles:[`@layer primeng{.p-skeleton{position:relative;overflow:hidden}.p-skeleton:after{content:"";animation:p-skeleton-animation 1.2s infinite;height:100%;left:0;position:absolute;right:0;top:0;transform:translate(-100%);z-index:1}.p-skeleton.p-skeleton-circle{border-radius:50%}.p-skeleton-none:after{animation:none}}@keyframes p-skeleton-animation{0%{transform:translate(-100%)}to{transform:translate(100%)}}
`],encapsulation:2,changeDetection:0})}return e})(),Me=(()=>{class e{static \u0275fac=function(o){return new(o||e)};static \u0275mod=S({type:e});static \u0275inj=_({imports:[b]})}return e})();var Ie=["amountInput"],Ne=e=>({"btn-disabled opacity-50":e});function Ve(e,s){if(e&1){let t=G();i(0,"div",19)(1,"div",20),f("click",function(){let r=v(t).$implicit,u=c(2);return y(u.selectedCategory=r)}),i(2,"div",21),d(3,"i"),n(),i(4,"span",22),a(5),n()()()}if(e&2){let t=s.$implicit,o=c(2);l(),m("ngClass",(o.selectedCategory==null?null:o.selectedCategory.id)===t.id?"border-900 surface-50":"surface-border"),l(),m("className","w-2rem h-2rem border-round-circle flex align-items-center justify-content-center "+t.colorClass),l(),N(t.icon+" text-sm"),l(2),k(t.name)}}function De(e,s){if(e&1){let t=G();i(0,"div",2)(1,"div",3),f("click",function(r){return v(t),y(r.stopPropagation())}),i(2,"h3",4),a(3),n(),i(4,"form",5),f("ngSubmit",function(){v(t);let r=c();return y(r.save())}),i(5,"div",6)(6,"span",7),a(7,"Monto"),n(),i(8,"div",8)(9,"span",9),a(10,"S/"),n(),i(11,"input",10,0),j("ngModelChange",function(r){v(t);let u=c();return D(u.amount,r)||(u.amount=r),y(r)}),n()()(),i(13,"div",11)(14,"span",12),a(15,"Categor\xEDa"),n(),i(16,"div",13),g(17,Ve,6,5,"div",14),n()(),i(18,"div",15)(19,"button",16),f("click",function(){v(t);let r=c();return y(r.close())}),a(20," Cancelar "),n(),i(21,"button",17),a(22," Guardar "),n()()()(),i(23,"div",18),f("click",function(){v(t);let r=c();return y(r.close())}),n()()}if(e&2){let t=c();l(2),m("ngClass",t.titleColor),l(),p(" Registrar ",t.type==="INGRESO"?"Ingreso":"Gasto"," "),l(5),m("ngClass",t.amount?"border-primary":"surface-border"),l(3),V("ngModel",t.amount),l(6),m("ngForOf",t.currentCategories),l(4),m("disabled",!t.isValid)("ngClass",$(7,Ne,!t.isValid))}}var Ee=(()=>{class e{constructor(){this.visible=!1,this.type="INGRESO",this.visibleChange=new R,this.saved=new R,this.amount=null,this.selectedCategory=null,this.incomeCategories=[{id:1,name:"Venta",icon:"fas fa-tshirt",colorClass:"bg-green-100 text-green-600"},{id:2,name:"Capital",icon:"fas fa-wallet",colorClass:"bg-blue-100 text-blue-600"}],this.expenseCategories=[{id:1,name:"Pasaje",icon:"fas fa-bus",colorClass:"bg-red-100 text-red-600"},{id:2,name:"Comida",icon:"fas fa-utensils",colorClass:"bg-orange-100 text-orange-600"},{id:3,name:"Puesto",icon:"fas fa-store",colorClass:"bg-purple-100 text-purple-600"},{id:4,name:"Otros",icon:"fas fa-ellipsis-h",colorClass:"surface-200 text-600"}]}ngOnChanges(t){t.visible&&t.visible.currentValue===!0&&setTimeout(()=>{this.amountInput&&this.amountInput.nativeElement.focus()},100)}get currentCategories(){return this.type==="INGRESO"?this.incomeCategories:this.expenseCategories}get titleColor(){return this.type==="INGRESO"?"text-green-600":"text-red-600"}get isValid(){return this.amount&&this.amount>0&&this.selectedCategory}close(){this.visible=!1,this.visibleChange.emit(!1),setTimeout(()=>{this.amount=null,this.selectedCategory=null},200)}save(){if(!this.isValid){console.warn("Formulario inv\xE1lido: Falta monto o categor\xEDa");return}this.saved.emit({type:this.type,amount:this.amount,category:this.selectedCategory}),this.close()}static{this.\u0275fac=function(o){return new(o||e)}}static{this.\u0275cmp=C({type:e,selectors:[["app-transaction-modal"]],viewQuery:function(o,r){if(o&1&&J(Ie,5),o&2){let u;K(u=X())&&(r.amountInput=u.first)}},inputs:{visible:"visible",type:"type"},outputs:{visibleChange:"visibleChange",saved:"saved"},standalone:!0,features:[Y,L],decls:1,vars:1,consts:[["amountInput",""],["class","fixed top-0 left-0 w-full h-full z-5 flex align-items-center justify-content-center","style","background-color: rgba(15, 23, 42, 0.4); backdrop-filter: blur(4px)",4,"ngIf"],[1,"fixed","top-0","left-0","w-full","h-full","z-5","flex","align-items-center","justify-content-center",2,"background-color","rgba(15, 23, 42, 0.4)","backdrop-filter","blur(4px)"],[1,"surface-card","border-round-2xl","shadow-8","p-5","w-full","max-w-25rem","m-3","slide-up","relative",3,"click"],[1,"text-xl","font-bold","mb-4","m-0",3,"ngClass"],[3,"ngSubmit"],[1,"mb-4"],[1,"text-xs","font-bold","text-500","block","mb-2"],[1,"flex","align-items-center","border-bottom-2","py-2","transition-colors","duration-200",3,"ngClass"],[1,"text-2xl","font-bold","text-400","mr-2"],["type","number","name","amount","placeholder","0.00",1,"w-full","text-3xl","font-bold","border-none","outline-none","text-900","bg-transparent",3,"ngModelChange","ngModel"],[1,"mb-5"],[1,"text-xs","font-bold","text-500","block","mb-3"],[1,"grid","formgrid"],["class","col-6 mb-3",4,"ngFor","ngForOf"],[1,"flex","gap-3"],["type","button",1,"w-full","surface-200","text-700","font-bold","py-3","border-round-xl","border-none","cursor-pointer","hover:surface-300","transition-colors",3,"click"],["type","submit",1,"w-full","bg-bluegray-900","text-white","font-bold","py-3","border-round-xl","border-none","cursor-pointer","hover:bg-bluegray-800","transition-colors","shadow-3",3,"disabled","ngClass"],[1,"absolute","inset-0","z-minus-1",3,"click"],[1,"col-6","mb-3"],[1,"cursor-pointer","border-1","border-round-xl","p-3","flex","align-items-center","gap-3","transition-all","transition-duration-200","hover:surface-50",3,"click","ngClass"],[3,"className"],[1,"font-bold","text-sm","text-900"]],template:function(o,r){o&1&&g(0,De,24,9,"div",1),o&2&&m("ngIf",r.visible)},dependencies:[b,w,ee,te,ue,ce,re,pe,le,se,de,me],styles:['@charset "UTF-8";.slide-up[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_slideUp .3s ease-out}@keyframes _ngcontent-%COMP%_slideUp{0%{transform:translateY(20px);opacity:0}to{transform:translateY(0);opacity:1}}.btn-disabled[_ngcontent-%COMP%]{opacity:.5;cursor:not-allowed!important}']})}}return e})();var je=(e,s)=>({"bg-green-100 text-green-700":e,"bg-red-100 text-red-700":s}),Le=(e,s)=>({"pi-money-bill text-green-500":e,"pi-mobile text-purple-500":s});function Oe(e,s){e&1&&d(0,"p-skeleton",3)}function Re(e,s){if(e&1&&(i(0,"div",15)(1,"div",16),d(2,"i",17),n(),i(3,"div")(4,"p",18),a(5," Caja Total "),n(),i(6,"h3",19),a(7),x(8,"number"),n()(),i(9,"div",20)(10,"span",21),a(11," Efec: "),i(12,"strong",22),a(13),x(14,"number"),n()(),i(15,"span",21),a(16," Dig: "),i(17,"strong",22),a(18),x(19,"number"),n()()()()),e&2){let t=c();l(7),p(" S/ ",h(8,3,t.cards().cash_total.amount,"1.2-2")," "),l(6),p("S/ ",h(14,6,t.cards().cash_total.cash,"1.0-0"),""),l(5),p("S/ ",h(19,9,t.cards().cash_total.digital,"1.0-0"),"")}}function Ge(e,s){e&1&&d(0,"p-skeleton",3)}function Pe(e,s){if(e&1&&(i(0,"div",23)(1,"div",24)(2,"div",25),d(3,"i",26),n(),i(4,"span",27),d(5,"i",28),a(6),n()(),i(7,"div")(8,"p",29),a(9," Ingresos Ventas "),n(),i(10,"h3",30),a(11),x(12,"number"),n()()()),e&2){let t=c();l(6),P(" ",t.cards().sales_income.growth>0?"+":"","",t.cards().sales_income.growth,"% "),l(5),p(" S/ ",h(12,3,t.cards().sales_income.amount,"1.2-2")," ")}}function Be(e,s){e&1&&d(0,"p-skeleton",3)}function ze(e,s){if(e&1&&(i(0,"div",23)(1,"div",24)(2,"div",31),d(3,"i",32),n()(),i(4,"div")(5,"p",29),a(6," Gastos Operativos "),n(),i(7,"h3",30),a(8),x(9,"number"),n(),i(10,"p",33),a(11),n()()()),e&2){let t=c();l(8),p(" S/ ",h(9,2,t.cards().expenses.amount,"1.2-2")," "),l(3),p(" ",t.cards().expenses.description," ")}}function Ae(e,s){e&1&&d(0,"p-skeleton",3)}function We(e,s){if(e&1&&(i(0,"div",23)(1,"div",24)(2,"div",34),d(3,"i",35),n()(),i(4,"div")(5,"p",29),a(6," Inversi\xF3n Stock "),n(),i(7,"h3",30),a(8),x(9,"number"),n(),i(10,"p",33),a(11),n()()()),e&2){let t=c();l(8),p(" S/ ",h(9,2,t.cards().stock_investment.amount,"1.2-2")," "),l(3),p(" ",t.cards().stock_investment.description," ")}}function He(e,s){e&1&&(i(0,"tr",36)(1,"th",37),a(2,"Concepto"),n(),i(3,"th",38),a(4,"Categor\xEDa"),n(),i(5,"th",38),a(6,"Fecha"),n(),i(7,"th",38),a(8,"M\xE9todo"),n(),i(9,"th",39),a(10,"Monto"),n()())}function Qe(e,s){if(e&1&&(i(0,"tr",40)(1,"td",41),a(2),n(),i(3,"td",38)(4,"span",42),a(5),n()(),i(6,"td",43),a(7),n(),i(8,"td",38)(9,"div",44),d(10,"i",45),a(11),n()(),i(12,"td",39)(13,"span",46),a(14),x(15,"number"),n()()()),e&2){let t=s.$implicit;l(2),k(t.concept),l(2),m("ngClass",B(12,je,t.category==="Venta"||t.category==="Ingreso",t.category==="Gasto")),l(),p(" ",t.category," "),l(2),k(t.date),l(3),m("ngClass",B(15,Le,t.method==="CASH",t.method!=="CASH")),l(),p(" ",t.method," "),l(2),m("ngClass",t.type==="income"?"text-green-600":"text-red-600"),l(),P(" ",t.type==="income"?"+":"-"," S/ ",h(15,9,t.amount,"1.2-2")," ")}}function Ue(e,s){e&1&&(i(0,"tr")(1,"td",47),d(2,"i",48),a(3," No hay movimientos recientes registrados. "),n()())}var Te=(()=>{class e{constructor(){this.financialSummaryService=E(Ce),this.cashflowService=E(_e),this.currentDate=new Date,this.datePipe=E(z),this.messageService=E(W),this.loading=I(!0),this.cards=I({cash_total:{amount:0,cash:0,digital:0},sales_income:{amount:0,growth:0},expenses:{amount:0,description:""},stock_investment:{amount:0,description:""}}),this.transactions=I([]),this.showModal=!1,this.modalType="INGRESO"}ngOnInit(){this.loadDashboardData()}loadDashboardData(){this.loading.set(!0),this.financialSummaryService.getSummary().subscribe({next:t=>{this.cards.set(t.cards),this.transactions.set(t.recent_transactions),this.loading.set(!1)},error:t=>{console.error("Error cargando dashboard",t),this.loading.set(!1)}})}openTransactionModal(t){this.modalType=t,this.showModal=!0}handleTransactionSave(t){this.cashflowService.registerSummaryMovement(t).subscribe({next:o=>{o.success&&(this.messageService.add({severity:"success",summary:"Guardado",detail:"Movimiento registrado correctamente"}),this.showModal=!1,this.loadDashboardData())},error:o=>{console.error(o),this.messageService.add({severity:"error",summary:"Error",detail:"No se pudo registrar el movimiento"})}})}static{this.\u0275fac=function(o){return new(o||e)}}static{this.\u0275cmp=C({type:e,selectors:[["app-financial-summary"]],standalone:!0,features:[Z([z,W]),L],decls:26,vars:9,consts:[[1,"flex","flex-column","gap-4","p-4","fadein-animation"],[1,"grid"],[1,"col-12","md:col-3"],["height","10rem","borderRadius","16px"],[1,"surface-card","border-round-2xl","border-1","surface-border","shadow-2","overflow-hidden"],[1,"p-4","border-bottom-1","surface-border","flex","flex-column","sm:flex-row","justify-content-between","align-items-center","gap-3"],[1,"font-bold","text-800","m-0","text-xl"],[1,"flex","gap-2"],["pButton","","label","Ingreso","icon","pi pi-plus",1,"p-button-success","p-button-outlined","p-button-sm","border-round-lg","font-bold",3,"click"],["pButton","","label","Gasto","icon","pi pi-minus",1,"p-button-danger","p-button-outlined","p-button-sm","border-round-lg","font-bold",3,"click"],["styleClass","p-datatable-sm",3,"value","loading","rowHover"],["pTemplate","header"],["pTemplate","body"],["pTemplate","emptymessage"],[3,"visibleChange","saved","visible","type"],[1,"bg-bluegray-900","border-round-2xl","p-4","text-white","shadow-4","relative","overflow-hidden","h-full","flex","flex-column","justify-content-between"],[1,"absolute","top-0","right-0","p-3","opacity-10"],[1,"pi","pi-wallet","text-6xl"],[1,"text-gray-400","text-xs","font-bold","uppercase","mb-2",2,"letter-spacing","1px"],[1,"text-4xl","font-bold","m-0","text-white"],[1,"flex","gap-2","text-xs","mt-3"],[1,"surface-800","p-2","border-round","border-1","border-700","text-gray-300"],[1,"text-white"],[1,"surface-card","border-round-2xl","p-4","border-1","surface-border","shadow-2","h-full","flex","flex-column","justify-content-between"],[1,"flex","justify-content-between","mb-3"],[1,"w-3rem","h-3rem","bg-green-50","border-round-lg","flex","align-items-center","justify-content-center","text-green-600"],[1,"pi","pi-arrow-down","text-xl","font-bold"],[1,"text-xs","font-bold","text-green-700","bg-green-100","px-2","py-1","border-round-2xl","h-fit","flex","align-items-center","gap-1"],[1,"pi","pi-chart-line","text-xs"],[1,"text-500","text-xs","font-bold","uppercase","m-0"],[1,"text-3xl","font-bold","text-900","mt-2","mb-0"],[1,"w-3rem","h-3rem","bg-red-50","border-round-lg","flex","align-items-center","justify-content-center","text-red-500"],[1,"pi","pi-arrow-up","text-xl","font-bold"],[1,"text-xs","text-400","mt-1","m-0"],[1,"w-3rem","h-3rem","bg-blue-50","border-round-lg","flex","align-items-center","justify-content-center","text-blue-600"],[1,"pi","pi-shopping-bag","text-xl","font-bold"],[1,"text-xs","uppercase","surface-50","text-500"],[1,"p-3","pl-4"],[1,"p-3"],[1,"p-3","pr-4","text-right"],[1,"border-bottom-1","surface-border","hover:surface-50","transition-colors"],[1,"p-3","pl-4","font-medium","text-900"],[1,"px-2","py-1","border-round","text-xs","font-bold","inline-block",3,"ngClass"],[1,"p-3","text-600","text-sm"],[1,"flex","align-items-center","gap-2","text-700","text-sm"],[1,"pi",3,"ngClass"],[1,"font-bold","text-lg",3,"ngClass"],["colspan","5",1,"text-center","p-5","text-500"],[1,"pi","pi-inbox","text-4xl","mb-2","block","text-300"]],template:function(o,r){o&1&&(i(0,"div",0)(1,"div",1)(2,"div",2),g(3,Oe,1,0,"p-skeleton",3)(4,Re,20,12),n(),i(5,"div",2),g(6,Ge,1,0,"p-skeleton",3)(7,Pe,13,6),n(),i(8,"div",2),g(9,Be,1,0,"p-skeleton",3)(10,ze,12,5),n(),i(11,"div",2),g(12,Ae,1,0,"p-skeleton",3)(13,We,12,5),n()(),i(14,"div",4)(15,"div",5)(16,"h3",6),a(17,"\xDAltimos Movimientos"),n(),i(18,"div",7)(19,"button",8),f("click",function(){return r.openTransactionModal("INGRESO")}),n(),i(20,"button",9),f("click",function(){return r.openTransactionModal("GASTO")}),n()()(),i(21,"p-table",10),g(22,He,11,0,"ng-template",11)(23,Qe,16,18,"ng-template",12)(24,Ue,4,0,"ng-template",13),n()()(),i(25,"app-transaction-modal",14),j("visibleChange",function(M){return D(r.showModal,M)||(r.showModal=M),M}),f("saved",function(M){return r.handleTransactionSave(M)}),n()),o&2&&(l(3),T(3,r.loading()?3:4),l(3),T(6,r.loading()?6:7),l(3),T(9,r.loading()?9:10),l(3),T(12,r.loading()?12:13),l(9),m("value",r.transactions())("loading",r.loading())("rowHover",!0),l(4),V("visible",r.showModal),m("type",r.modalType))},dependencies:[b,w,ne,xe,ge,ae,ve,be,he,ye,fe,Me,we,Ee]})}}return e})();var Ye=[{path:"",component:Te},{path:"",pathMatch:"full",redirectTo:"financial-summary"}],ke=(()=>{class e{static{this.\u0275fac=function(o){return new(o||e)}}static{this.\u0275mod=S({type:e})}static{this.\u0275inj=_({imports:[A.forChild(Ye),A]})}}return e})();var Ft=(()=>{class e{static{this.\u0275fac=function(o){return new(o||e)}}static{this.\u0275mod=S({type:e})}static{this.\u0275inj=_({imports:[b,ke]})}}return e})();export{Ft as FinancialSummaryModule};
