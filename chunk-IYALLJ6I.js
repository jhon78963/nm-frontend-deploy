import{d as pe}from"./chunk-VBIUCSSG.js";import{b as O,f as j,k as N,m as me,u as Q}from"./chunk-RXSAQ4RI.js";import{A as _,Aa as d,Ab as K,Ba as m,Bb as C,C as P,D as U,Ha as ne,I as u,Ia as re,J as f,Ja as ae,La as l,Ma as I,Na as g,Oa as se,Pa as V,Qa as F,Ra as z,Ta as k,Ub as X,W as s,a as Y,b as $,d as T,da as b,db as L,f as Z,fb as B,ga as y,ia as H,ja as G,k as q,ka as h,mb as M,nb as le,oa as S,ob as ce,q as ee,qa as oe,r as te,ra as R,sa as D,ta as n,ua as a,va as p,vb as de,w as ie,x as W,za as v}from"./chunk-RH3Q74CP.js";var E=(()=>{class o{constructor(){this.apiService=_(pe),this.cart=b([]),this.currentCustomer=b(null),this.modalState=b({isOpen:!1,product:null,isEditing:!1}),this.toastMessage=b(null),this.paymentMethod=b("EFECTIVO"),this.isLoading=b(!1),this.grandTotal=M(()=>this.cart().reduce((e,t)=>e+t.total,0)),this.totalItems=M(()=>this.cart().reduce((e,t)=>e+t.quantity,0))}searchProductBySku(e){return T(this,null,function*(){this.isLoading.set(!0);try{return yield q(this.apiService.get(`pos/products?sku=${e}`))}catch(t){console.error("Error buscando producto:",t),this.showToast("Producto no encontrado");return}finally{this.isLoading.set(!1)}})}searchCustomerByDni(e){return T(this,null,function*(){this.isLoading.set(!0);try{let t=yield q(this.apiService.get(`pos/customers?dni=${e}`));return t?(this.currentCustomer.set(t),this.showToast("Cliente encontrado"),!0):!1}catch(t){return console.error("Error buscando cliente:",t),this.showToast("Cliente no encontrado / Error API"),!1}finally{this.isLoading.set(!1)}})}processCheckout(){return T(this,null,function*(){if(this.cart().length===0)return this.showToast("El carrito est\xE1 vac\xEDo");this.isLoading.set(!0);let e={customer:{id:this.currentCustomer()?.id},total:this.grandTotal(),payment_method:this.paymentMethod(),items:this.cart().map(t=>({name:t.name,quantity:t.quantity,unitPrice:t.unitPrice,total:t.total,size:t.size,color:{product_size_id:t.color.product_size_id,color_id:t.color.color_id,colorName:t.color.colorName,hex:t.color.hex,stock:t.color.stock}}))};try{let t=yield q(this.apiService.post("pos/checkout",e));t.success?(this.showToast(`Venta Registrada ID: ${t.sale_id}
Imprimiendo ticket...`),this.printTicket(t.sale_id),this.clearCart()):this.showToast("Error al procesar venta")}catch(t){this.showToast("Error: Intente nuevamente!"),console.error(t)}finally{this.isLoading.set(!1)}})}addItem(e){this.cart.update(t=>[...t,e]),this.showToast("Producto Agregado")}updateItem(e){this.cart.update(t=>t.map(i=>i.cartId===e.cartId?e:i)),this.showToast("\xCDtem Actualizado")}removeItem(e){this.cart.update(t=>t.filter(i=>i.cartId!==e))}clearCart(){this.cart.set([]),this.currentCustomer.set(null),this.paymentMethod.set("EFECTIVO")}updateQuantity(e,t){this.cart.update(i=>i.map(r=>{if(r.cartId===e){let c=r.quantity+t;return c<=0?r:c>r.color.stock?(this.showToast(`Stock m\xE1x: ${r.color.stock}`),r):$(Y({},r),{quantity:c,total:c*r.unitPrice})}return r}))}openAddModal(e){this.modalState.set({isOpen:!0,product:e,isEditing:!1})}openEditModal(e){this.searchProductBySku(e.sku).then(t=>{t&&this.modalState.set({isOpen:!0,product:t,isEditing:!0,editingCartItem:e})})}closeModal(){this.modalState.set({isOpen:!1,product:null,isEditing:!1})}showToast(e){this.toastMessage.set(e),setTimeout(()=>this.toastMessage.set(null),2500)}setPaymentMethod(e){this.paymentMethod.set(e)}printTicket(e){let i=`${this.apiService.BASE_URL.replace(/\/api\/?$/,"")}/pos/sales/${e}/ticket`,r=document.createElement("iframe");r.style.display="none",r.src=i,document.body.appendChild(r),r.onload=()=>{try{r.contentWindow?.print()}catch(c){console.error(c)}setTimeout(()=>{document.body.removeChild(r)},5e3)}}static{this.\u0275fac=function(t){return new(t||o)}}static{this.\u0275prov=ie({token:o,factory:o.\u0275fac,providedIn:"root"})}}return o})();function ye(o,x){if(o&1){let e=v();n(0,"div",11)(1,"div",12)(2,"div",13),p(3,"i",14),a(),n(4,"div",15)(5,"div",16),l(6),a(),n(7,"div",17),l(8),a()()(),n(9,"button",18),d("click",function(){u(e);let i=m();return f(i.reset())}),p(10,"i",19),a()()}if(o&2){let e,t,i=m();s(6),g(" ",(e=i.posService.currentCustomer())==null?null:e.name," "),s(2),g(" ",(t=i.posService.currentCustomer())==null?null:t.dni," ")}}var fe=(()=>{class o{constructor(){this.posService=_(E),this.dniQuery=""}search(){this.posService.searchCustomerByDni(this.dniQuery)||(this.dniQuery="")}reset(){this.posService.currentCustomer.set(null),this.dniQuery=""}static{this.\u0275fac=function(t){return new(t||o)}}static{this.\u0275cmp=P({type:o,selectors:[["app-pos-header"]],standalone:!0,features:[k],decls:13,vars:2,consts:[[1,"bg-white","px-3","py-3","shadow-1","z-2","relative","border-bottom-1","border-gray-100","flex-shrink-0"],[1,"flex","justify-content-between","align-items-center","mb-2"],[1,"pi","pi-bars","text-xl","text-gray-500"],[1,"font-bold","text-gray-700"],[1,"w-2rem","h-2rem","border-circle","bg-gray-200","flex","align-items-center","justify-content-center"],[1,"pi","pi-user","text-gray-500"],[1,"relative","w-full"],[1,"pi","pi-user","absolute","text-gray-400","z-1",2,"top","50%","left","1rem","transform","translateY(-50%)"],["type","tel","placeholder","DNI / RUC Cliente","inputmode","numeric",1,"w-full","border-round-xl","py-3","pl-6","pr-6","border-none","bg-gray-100","font-medium","text-gray-800","focus:bg-white","focus:shadow-input","transition-all",3,"ngModelChange","keydown.enter","ngModel"],[1,"absolute","right-0","top-0","h-full","w-3rem","border-none","bg-indigo-600","border-round-right-xl","text-white","cursor-pointer","hover:bg-indigo-700",3,"click"],[1,"pi","pi-search"],[1,"mt-2","bg-indigo-50","border-1","border-indigo-100","border-round-xl","p-2","flex","justify-content-between","align-items-center","slide-down","animation-duration-200"],[1,"flex","align-items-center","gap-2","overflow-hidden"],[1,"bg-indigo-600","text-white","border-circle","w-2rem","h-2rem","flex","align-items-center","justify-content-center","flex-shrink-0"],[1,"pi","pi-check","text-xs"],[1,"overflow-hidden"],[1,"font-bold","text-indigo-900","text-sm","white-space-nowrap","overflow-hidden","text-overflow-ellipsis"],[1,"text-xs","text-indigo-500","font-medium"],[1,"bg-transparent","border-none","text-gray-400","hover:text-gray-600","cursor-pointer","p-2",3,"click"],[1,"pi","pi-times"]],template:function(t,i){t&1&&(n(0,"header",0)(1,"div",1),p(2,"i",2),n(3,"div",3),l(4,"POS"),a(),n(5,"div",4),p(6,"i",5),a()(),n(7,"div",6),p(8,"i",7),n(9,"input",8),z("ngModelChange",function(c){return F(i.dniQuery,c)||(i.dniQuery=c),c}),d("keydown.enter",function(){return i.search()}),a(),n(10,"button",9),d("click",function(){return i.search()}),p(11,"i",10),a()(),y(12,ye,11,2,"div",11),a()),t&2&&(s(9),V("ngModel",i.dniQuery),s(3),S(12,i.posService.currentCustomer()?12:-1))},dependencies:[C,Q,O,j,N],styles:[".shadow-input[_ngcontent-%COMP%]{box-shadow:0 0 0 4px #6366f11a}.slide-down[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_slidedown .3s cubic-bezier(.16,1,.3,1)}@keyframes _ngcontent-%COMP%_slidedown{0%{transform:translateY(-10px);opacity:0}to{transform:translateY(0);opacity:1}}"]})}}return o})();var xe=(()=>{class o{constructor(){this.posService=_(E)}static{this.\u0275fac=function(t){return new(t||o)}}static{this.\u0275cmp=P({type:o,selectors:[["app-pos-footer"]],standalone:!0,features:[k],decls:24,vars:34,consts:[[1,"fixed","bottom-0","left-0","w-full","bg-white","z-4","shadow-top","border-top-1","border-gray-100","px-4","py-3","fadein-animation"],[1,"flex","gap-2","mb-3"],[1,"flex-1","border-1","border-round-xl","p-2","cursor-pointer","transition-all","flex","flex-column","align-items-center","justify-content-center","gap-1",3,"click"],[1,"pi","pi-money-bill","text-xl"],[1,"text-xs","font-bold"],[1,"pi","pi-qrcode","text-xl"],[1,"pi","pi-credit-card","text-xl"],[1,"flex","justify-content-between","align-items-center","mb-3"],[1,"text-xs","font-bold","text-gray-500","uppercase","letter-spacing-1"],[1,"text-3xl","font-black","text-gray-900"],[1,"w-full","bg-indigo-700","text-white","py-3","border-round-xl","font-bold","text-lg","shadow-3","border-none","cursor-pointer","hover:bg-indigo-800","active:scale-95","transition-all","flex","justify-content-center","align-items-center","gap-2",3,"click"],[1,"pi","pi-check-circle","text-xl"]],template:function(t,i){t&1&&(n(0,"div",0)(1,"div",1)(2,"div",2),d("click",function(){return i.posService.setPaymentMethod("EFECTIVO")}),p(3,"i",3),n(4,"span",4),l(5,"Efectivo"),a()(),n(6,"div",2),d("click",function(){return i.posService.setPaymentMethod("YAPE/PLIN")}),p(7,"i",5),n(8,"span",4),l(9,"Yape/Plin"),a()(),n(10,"div",2),d("click",function(){return i.posService.setPaymentMethod("TRANSFERENCIA")}),p(11,"i",6),n(12,"span",4),l(13,"Tarjeta"),a()()(),n(14,"div",7)(15,"span",8),l(16,"Total a Pagar"),a(),n(17,"span",9),l(18),L(19,"number"),a()(),n(20,"button",10),d("click",function(){return i.posService.processCheckout()}),p(21,"i",11),n(22,"span"),l(23,"COBRAR"),a()()()),t&2&&(s(2),h("border-indigo-600",i.posService.paymentMethod()==="EFECTIVO")("bg-indigo-50",i.posService.paymentMethod()==="EFECTIVO")("text-indigo-700",i.posService.paymentMethod()==="EFECTIVO")("border-gray-200",i.posService.paymentMethod()!=="EFECTIVO")("text-gray-500",i.posService.paymentMethod()!=="EFECTIVO"),s(4),h("border-pink-500",i.posService.paymentMethod()==="YAPE/PLIN")("bg-pink-50",i.posService.paymentMethod()==="YAPE/PLIN")("text-pink-600",i.posService.paymentMethod()==="YAPE/PLIN")("border-gray-200",i.posService.paymentMethod()!=="YAPE/PLIN")("text-gray-500",i.posService.paymentMethod()!=="YAPE/PLIN"),s(4),h("border-indigo-600",i.posService.paymentMethod()==="TRANSFERENCIA")("bg-indigo-50",i.posService.paymentMethod()==="TRANSFERENCIA")("text-indigo-700",i.posService.paymentMethod()==="TRANSFERENCIA")("border-gray-200",i.posService.paymentMethod()!=="TRANSFERENCIA")("text-gray-500",i.posService.paymentMethod()!=="TRANSFERENCIA"),s(8),g("S/ ",B(19,31,i.posService.grandTotal(),"1.2-2"),""))},dependencies:[C,K],styles:[".shadow-top[_ngcontent-%COMP%]{box-shadow:0 -4px 20px #00000014}.fadein-animation[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_fadein .3s ease-out}@keyframes _ngcontent-%COMP%_fadein{0%{opacity:0}to{opacity:1}}"]})}}return o})();var Ce=(o,x)=>x.colorName;function Se(o,x){if(o&1){let e=v();n(0,"div",27),d("click",function(){let i=u(e).$implicit,r=m(2);return f(r.selectSize(i))}),l(1),a()}if(o&2){let e=x.$implicit,t=m(2);h("border-indigo-600",t.tempSize()===e)("bg-indigo-600",t.tempSize()===e)("text-white",t.tempSize()===e)("border-gray-100",t.tempSize()!==e)("bg-white",t.tempSize()!==e)("text-gray-600",t.tempSize()!==e),s(),g(" ",e," ")}}function we(o,x){if(o&1&&(n(0,"span",28),l(1),a()),o&2){let e=x;h("text-green-600",e.stock>5)("text-red-500",e.stock<=5),s(),g(" Stock: ",e.stock," ")}}function Pe(o,x){o&1&&p(0,"i",30)}function ke(o,x){if(o&1){let e=v();n(0,"div",29),d("click",function(){let i=u(e).$implicit,r=m(2);return f(i.stock>0?r.selectColor(i):null)}),y(1,Pe,1,0,"i",30),a()}if(o&2){let e=x.$implicit,t=m(2);G("background-color",e.hex),h("border-indigo-500",t.tempColor()===e)("border-transparent",t.tempColor()!==e&&e.hex!=="#ffffff")("border-gray-200",e.hex==="#ffffff")("opacity-40",e.stock===0),s(),S(1,t.tempColor()===e?1:-1)}}function Ee(o,x){if(o&1){let e=v();n(0,"div",0)(1,"div",1)(2,"button",2),d("click",function(){u(e);let i=m();return f(i.posService.closeModal())}),p(3,"i",3),a(),n(4,"div",4)(5,"h2",5),l(6),a(),n(7,"p",6),l(8),a()(),n(9,"div",7)(10,"span",8),l(11,"Precio Unitario:"),a(),n(12,"div",9)(13,"span",10),l(14,"S/"),a(),n(15,"input",11),z("ngModelChange",function(i){u(e);let r=m();return F(r.tempPrice,i)||(r.tempPrice=i),f(i)}),d("focus",function(i){return u(e),f(i.target.select())}),a()()(),n(16,"div",12)(17,"span",13),l(18,"1. Selecciona Talla"),a(),n(19,"div",14),R(20,Se,2,13,"div",15,oe),a()(),n(22,"div",12)(23,"div",16)(24,"span",17),l(25,"2. Selecciona Color"),a(),y(26,we,2,5,"span",18),a(),n(27,"div",19),R(28,ke,2,11,"div",20,Ce),a()(),n(30,"div",21)(31,"div",22)(32,"button",23),d("click",function(){u(e);let i=m();return f(i.adjustTempQty(-1))}),l(33," - "),a(),n(34,"span",24),l(35),a(),n(36,"button",25),d("click",function(){u(e);let i=m();return f(i.adjustTempQty(1))}),l(37," + "),a()(),n(38,"button",26),d("click",function(){u(e);let i=m();return f(i.confirm())}),l(39),a()()()()}if(o&2){let e,t,i=m();s(6),g(" ",(e=i.posService.modalState().product)==null?null:e.name," "),s(2),g(" SKU: ",i.displaySku()," "),s(7),V("ngModel",i.tempPrice),s(5),D(i.availableSizes()),s(2),h("opacity-50",!i.tempSize())("pointer-events-none",!i.tempSize()),s(4),S(26,(t=i.tempColor())?26:-1,t),s(2),D(i.availableColors()),s(7),I(i.tempQty),s(3),H("disabled",!i.tempSize()||!i.tempColor()),s(),g(" ",i.posService.modalState().isEditing?"GUARDAR":"AGREGAR"," ")}}var ge=(()=>{class o{constructor(){this.posService=_(E),this.tempSize=b(null),this.tempColor=b(null),this.tempQty=1,this.tempPrice=0,this.displaySku=M(()=>{let e=this.posService.modalState(),t=this.tempColor();return e.product?t&&t.sku?t.sku:e.product.sku:""}),this.availableSizes=M(()=>{let e=this.posService.modalState().product;return e?Object.keys(e.variants):[]}),this.availableColors=M(()=>{let e=this.posService.modalState().product,t=this.tempSize();return!e||!t?[]:e.variants[t]||[]}),ce(()=>{let e=this.posService.modalState();le(()=>{if(e.isOpen){if(this.tempSize.set(null),this.tempColor.set(null),this.tempQty=1,this.tempPrice=0,e.isEditing&&e.editingCartItem){let t=e.editingCartItem;if(this.tempSize.set(t.size),this.tempQty=t.quantity,this.tempPrice=t.unitPrice,e.product&&e.product.variants[t.size]){let r=e.product.variants[t.size].find(c=>c.color_id===t.color.color_id&&c.colorName===t.color.colorName);r&&this.tempColor.set(r)}}else if(e.product){let t=e.product.sku,i=null,r=null;for(let c in e.product.variants){let J=e.product.variants[c].find(be=>be.sku===t);if(J){i=c,r=J;break}}if(i){if(this.selectSize(i),r)if(this.tempPrice=r.price,r.color_id>0)this.selectColor(r);else{let c=e.product.variants[i].find(w=>w.color_id===0);c&&this.selectColor(c)}}else this.tempPrice=e.product.basePrice}}})},{allowSignalWrites:!0})}selectSize(e){this.tempSize.set(e);let t=this.posService.modalState().product,i=t&&t.variants[e]?t.variants[e]:[];i.length>0?this.selectColor(i[0]):this.tempColor.set(null)}selectColor(e){this.tempColor.set(e),this.tempPrice=e.price}adjustTempQty(e){let t=this.tempQty+e;if(t<1)return;let i=this.tempColor();i&&t>i.stock||(this.tempQty=t)}confirm(){let e=this.posService.modalState(),t=this.tempSize(),i=this.tempColor();if(!e.product||!t||!i)return;let r=this.tempPrice*this.tempQty;if(e.isEditing&&e.editingCartItem){let c=$(Y({},e.editingCartItem),{size:t,color:i,quantity:this.tempQty,unitPrice:this.tempPrice,total:r});this.posService.updateItem(c)}else{let c={cartId:Date.now(),productId:e.product.id,sku:e.product.sku,name:e.product.name,size:t,color:i,quantity:this.tempQty,unitPrice:this.tempPrice,total:r};this.posService.addItem(c)}this.posService.closeModal()}static{this.\u0275fac=function(t){return new(t||o)}}static{this.\u0275cmp=P({type:o,selectors:[["app-pos-selector"]],standalone:!0,features:[k],decls:1,vars:1,consts:[[1,"fixed","top-0","left-0","w-full","h-full","z-6","flex","align-items-end","sm:align-items-center","justify-content-center","glass-overlay","fadein-animation"],[1,"bg-white","w-full","sm:w-30rem","border-round-top-2xl","sm:border-round-2xl","p-4","shadow-6","slide-up","max-h-screen","overflow-y-auto","relative"],[1,"absolute","top-0","right-0","m-3","bg-transparent","border-none","text-gray-400","hover:text-gray-600","cursor-pointer","p-2",3,"click"],[1,"pi","pi-times","text-xl"],[1,"mb-4","pr-5"],[1,"text-xl","font-bold","text-gray-900","m-0","line-height-2"],[1,"text-gray-500","text-sm","font-mono","m-0","mt-1"],[1,"mb-4","bg-yellow-50","border-1","border-yellow-200","border-round-xl","p-3","flex","justify-content-between","align-items-center"],[1,"text-xs","font-bold","text-yellow-800","uppercase"],[1,"relative"],[1,"absolute","text-gray-500","text-lg","font-bold",2,"left","0","top","50%","transform","translateY(-50%)"],["type","number",1,"w-8rem","text-right","font-black","text-2xl","bg-transparent","border-none","outline-none","text-gray-900","p-0",3,"ngModelChange","focus","ngModel"],[1,"mb-4"],[1,"text-xs","font-bold","text-gray-400","uppercase","block","mb-2"],[1,"flex","gap-2","flex-wrap"],[1,"px-4","py-3","border-1","border-round-xl","cursor-pointer","transition-all","font-bold","text-sm","min-w-3rem","text-center","select-none","shadow-1",3,"border-indigo-600","bg-indigo-600","text-white","border-gray-100","bg-white","text-gray-600"],[1,"flex","justify-content-between","mb-2"],[1,"text-xs","font-bold","text-gray-400","uppercase"],[1,"text-xs","font-bold",3,"text-green-600","text-red-500"],[1,"flex","gap-3","flex-wrap"],[1,"w-3rem","h-3rem","border-circle","border-2","cursor-pointer","relative","shadow-1","transition-transform","active:scale-90","flex","align-items-center","justify-content-center",3,"border-indigo-500","border-transparent","border-gray-200","background-color","opacity-40"],[1,"flex","gap-3","pt-3","border-top-1","border-gray-300"],[1,"flex","align-items-center","border-1","border-gray-200","border-round-xl","w-10rem","justify-content-between","px-1","bg-white","shadow-1"],[1,"p-3","border-none","bg-transparent","text-gray-500","font-bold","hover:text-black","cursor-pointer","text-xl",3,"click"],[1,"font-bold","text-xl","text-gray-800"],[1,"p-3","border-none","bg-transparent","text-indigo-600","font-bold","hover:text-indigo-800","cursor-pointer","text-xl",3,"click"],[1,"flex-1","font-bold","py-3","bg-gray-900","text-white","border-round-xl","shadow-3","border-none","cursor-pointer","hover:bg-black","transition-all","disabled:opacity-50","text-lg",3,"click","disabled"],[1,"px-4","py-3","border-1","border-round-xl","cursor-pointer","transition-all","font-bold","text-sm","min-w-3rem","text-center","select-none","shadow-1",3,"click"],[1,"text-xs","font-bold"],[1,"w-3rem","h-3rem","border-circle","border-2","cursor-pointer","relative","shadow-1","transition-transform","active:scale-90","flex","align-items-center","justify-content-center",3,"click"],[1,"pi","pi-check","text-white","text-xl","shadow-2","border-circle","p-1","bg-black-alpha-10"]],template:function(t,i){t&1&&y(0,Ee,40,11,"div",0),t&2&&S(0,i.posService.modalState().isOpen?0:-1)},dependencies:[C,Q,O,me,j,N],styles:[".glass-overlay[_ngcontent-%COMP%]{background:#0009;-webkit-backdrop-filter:blur(4px);backdrop-filter:blur(4px)}.fadein-animation[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_fadein .2s ease-out}.slide-up[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_slideup .3s cubic-bezier(.16,1,.3,1)}@keyframes _ngcontent-%COMP%_fadein{0%{opacity:0}to{opacity:1}}@keyframes _ngcontent-%COMP%_slideup{0%{transform:translateY(100%);opacity:0}to{transform:translateY(0);opacity:1}}"]})}}return o})();var Me=["barcodeInput"],Te=(o,x)=>x.cartId;function Ie(o,x){if(o&1&&(n(0,"div",3),p(1,"i",15),n(2,"span",16),l(3),a()()),o&2){let e=m();s(3),I(e.posService.toastMessage())}}function Ve(o,x){if(o&1){let e=v();n(0,"span",17),d("click",function(){u(e);let i=m();return f(i.posService.clearCart())}),l(1,"Vaciar"),a()}}function Fe(o,x){o&1&&(n(0,"div",12),p(1,"i",18),n(2,"span",19),l(3,"Empieza a escanear"),a()())}function ze(o,x){if(o&1){let e=v();n(0,"div",21),p(1,"div",22),n(2,"div",23)(3,"div",24)(4,"span",25),l(5),a(),n(6,"i",26),d("click",function(){let i=u(e).$implicit,r=m(2);return f(r.posService.removeItem(i.cartId))}),a()(),n(7,"div",27)(8,"div",28),d("click",function(){let i=u(e).$implicit,r=m(2);return f(r.posService.openEditModal(i))}),n(9,"span",29),l(10),a(),p(11,"i",30),a(),n(12,"span",31),d("click",function(){let i=u(e).$implicit,r=m(2);return f(r.posService.openEditModal(i))}),l(13),L(14,"number"),a()(),n(15,"div",32)(16,"div",33)(17,"button",34),d("click",function(){let i=u(e).$implicit,r=m(2);return f(r.posService.updateQuantity(i.cartId,-1))}),l(18," - "),a(),n(19,"span",35),l(20),a(),n(21,"button",36),d("click",function(){let i=u(e).$implicit,r=m(2);return f(r.posService.updateQuantity(i.cartId,1))}),l(22," + "),a()(),n(23,"span",37),l(24),L(25,"number"),a()()()()}if(o&2){let e=x.$implicit;s(),G("background-color",e.color.hex),h("border-1",e.color.hex==="#ffffff")("border-gray-200",e.color.hex==="#ffffff"),s(4),I(e.name),s(5),se("",e.size," \u2022 ",e.color.colorName,""),s(3),g(" S/ ",B(14,12,e.unitPrice,"1.2-2")," "),s(7),I(e.quantity),s(4),g("Total: S/ ",B(25,15,e.total,"1.2-2"),"")}}function Oe(o,x){if(o&1&&(n(0,"div",20),R(1,ze,26,18,"div",21,Te),a()),o&2){let e=m();s(),D(e.posService.cart())}}var he=(()=>{class o{constructor(){this.posService=_(E),this.barcodeQuery="",this.barcodeSubject=new Z}ngOnInit(){this.barcodeSubscription=this.barcodeSubject.pipe(ee(300),te()).subscribe(e=>{e&&this.onScan()})}onScan(){return T(this,null,function*(){let e=this.barcodeQuery.trim();if(!e)return;let t=yield this.posService.searchProductBySku(e);t?(this.posService.openAddModal(t),this.barcodeQuery=""):this.barcodeQuery=""})}onQueryChange(e){this.barcodeSubject.next(e)}ngAfterViewChecked(){!this.posService.modalState().isOpen&&this.barcodeInput}ngOnDestroy(){this.barcodeSubscription&&this.barcodeSubscription.unsubscribe()}static{this.\u0275fac=function(t){return new(t||o)}}static{this.\u0275cmp=P({type:o,selectors:[["app-pos"]],viewQuery:function(t,i){if(t&1&&ne(Me,5),t&2){let r;re(r=ae())&&(i.barcodeInput=r.first)}},standalone:!0,features:[k],decls:18,vars:5,consts:[["mainScroll",""],["barcodeInput",""],[1,"flex","flex-column","h-screen","bg-ground","font-family","overflow-hidden","relative","bg-white","rounded-xl"],[1,"fixed","top-0","left-50","border-round-2xl","mt-4","px-4","py-3","shadow-6","z-5","bg-gray-900","text-white","flex","align-items-center","gap-2","fadein-animation",2,"transform","translateX(-50%)"],[1,"flex-1","overflow-y-auto","p-3","pb-8",2,"padding-bottom","140px !important"],[1,"mb-4","bg-white","border-round-xl","shadow-1","overflow-hidden","flex","align-items-center","border-1","border-gray-100"],["type","text","placeholder","Escanear c\xF3digo...","autofocus","",1,"flex-1","py-3","px-3","text-lg","font-mono","border-none","outline-none","text-gray-800","placeholder-gray-400",3,"ngModelChange","ngModel"],[1,"bg-gray-100","text-gray-600","border-none","px-4","py-3","cursor-pointer","hover:bg-gray-200","border-left-1","border-gray-200",3,"click"],[1,"pi","pi-barcode","text-xl"],[1,"flex","justify-content-between","align-items-end","mb-3","px-1","border-bottom-1","border-gray-200","pb-2"],[1,"text-xs","font-bold","text-gray-500","uppercase","tracking-widest"],["class","text-xs font-bold text-red-500 cursor-pointer hover:text-red-700 uppercase",3,"click",4,"ngIf"],[1,"flex","flex-column","align-items-center","justify-content-center","py-8","opacity-40","text-gray-400"],[1,"z-2"],[1,"z-3"],[1,"pi","pi-info-circle","text-lg"],[1,"font-bold","text-sm"],[1,"text-xs","font-bold","text-red-500","cursor-pointer","hover:text-red-700","uppercase",3,"click"],[1,"pi","pi-shopping-bag","text-6xl","mb-3","text-gray-300"],[1,"text-sm","font-medium"],[1,"flex","flex-column","gap-3"],[1,"bg-white","p-3","border-round-2xl","shadow-1","flex","gap-3","relative","overflow-hidden","fadein-animation","border-1","border-gray-50","item-card"],[1,"w-3rem","h-3rem","border-circle","shadow-1","flex-shrink-0","mt-1"],[1,"flex-1","min-w-0"],[1,"flex","justify-content-between","align-items-start","mb-1"],[1,"font-bold","text-gray-900","text-sm","line-height-2","block","pr-2"],[1,"pi","pi-trash","text-red-300","hover:text-red-500","cursor-pointer","p-1",3,"click"],[1,"flex","align-items-center","flex-wrap","gap-2"],[1,"bg-gray-50","border-1","border-gray-200","border-round-lg","px-2","py-1","flex","align-items-center","gap-1","cursor-pointer","hover:bg-gray-100","transition-colors",3,"click"],[1,"text-xs","font-bold","text-gray-600","uppercase"],[1,"pi","pi-pencil","text-xs","text-indigo-400","ml-1"],[1,"ml-auto","font-bold","text-indigo-600","text-sm","cursor-pointer","border-bottom-1","border-indigo-300",3,"click"],[1,"flex","justify-content-between","align-items-center","mt-3","pt-2","border-top-1","border-gray-100"],[1,"flex","align-items-center","bg-gray-50","border-round-lg","border-1","border-gray-200","h-2rem","shadow-none"],[1,"border-none","bg-transparent","px-3","h-full","text-gray-500","font-bold","hover:bg-gray-200","border-round-left-lg","cursor-pointer",3,"click"],[1,"font-bold","text-sm","w-2rem","text-center"],[1,"border-none","bg-transparent","px-3","h-full","text-indigo-600","font-bold","hover:bg-indigo-50","border-round-right-lg","cursor-pointer",3,"click"],[1,"font-bold","text-sm","text-gray-800"]],template:function(t,i){if(t&1){let r=v();n(0,"div",2),y(1,Ie,4,1,"div",3),p(2,"app-pos-header"),n(3,"main",4,0)(5,"div",5)(6,"input",6,1),z("ngModelChange",function(w){return u(r),F(i.barcodeQuery,w)||(i.barcodeQuery=w),f(w)}),d("ngModelChange",function(w){return u(r),f(i.onQueryChange(w))}),a(),n(8,"button",7),d("click",function(){return u(r),f(i.onScan())}),p(9,"i",8),a()(),n(10,"div",9)(11,"span",10),l(12),a(),y(13,Ve,2,0,"span",11),a(),y(14,Fe,4,0,"div",12)(15,Oe,3,0),a(),p(16,"app-pos-footer",13)(17,"app-pos-selector",14),a()}t&2&&(s(),S(1,i.posService.toastMessage()?1:-1),s(5),V("ngModel",i.barcodeQuery),s(6),g("Carrito (",i.posService.totalItems(),")"),s(),H("ngIf",i.posService.cart().length>0),s(),S(14,i.posService.cart().length===0?14:15))},dependencies:[C,de,K,Q,O,j,N,fe,xe,ge],styles:[".fadein-animation[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_fadein .3s ease-out}@keyframes _ngcontent-%COMP%_fadein{0%{opacity:0}to{opacity:1}}.item-card[_ngcontent-%COMP%]{transition:transform .1s}.item-card[_ngcontent-%COMP%]:active{transform:scale(.98)}main[_ngcontent-%COMP%]::-webkit-scrollbar{width:0px;background:transparent}"]})}}return o})();var je=[{path:"",component:he},{path:"",pathMatch:"full",redirectTo:"sales/pos"}],_e=(()=>{class o{static{this.\u0275fac=function(t){return new(t||o)}}static{this.\u0275mod=U({type:o})}static{this.\u0275inj=W({imports:[X.forChild(je),X]})}}return o})();var St=(()=>{class o{static{this.\u0275fac=function(t){return new(t||o)}}static{this.\u0275mod=U({type:o})}static{this.\u0275inj=W({imports:[C,_e]})}}return o})();export{St as PosModule};
