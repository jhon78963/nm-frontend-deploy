import{a as be}from"./chunk-7JNPHJRQ.js";import{a as ve,b as he}from"./chunk-R2W37JHH.js";import{a as ge}from"./chunk-KMCLKCAE.js";import{a as xe}from"./chunk-ZI33VMUX.js";import{m as ue,p as fe}from"./chunk-A4YBSHQE.js";import"./chunk-ZRB5JYID.js";import"./chunk-DECUXDPT.js";import"./chunk-FTJNOPBC.js";import{d as de,f as pe}from"./chunk-53BCAK53.js";import{d as ee}from"./chunk-NELNUKEX.js";import{b as ce}from"./chunk-MROZGMZP.js";import"./chunk-S23T3VNK.js";import"./chunk-ZSZR532A.js";import{b as ie,f as ne,g as oe,i as ae,k as re,l as le,m as se,w as me}from"./chunk-3IAGLYRS.js";import{k as A,p as te}from"./chunk-56NTXRTG.js";import{i as R}from"./chunk-BQWNWUNE.js";import"./chunk-LUKISEWT.js";import{Ab as f,Bb as d,Hb as U,Ib as Y,Jb as q,Lb as o,Lc as j,Mb as w,Nb as p,Nc as X,Ob as G,Oc as Z,Pb as k,Qb as I,Ra as a,Rb as N,S as W,Sb as J,Sc as B,T as E,Tb as V,Tc as $,Uc as _,Wb as K,X as H,Xb as P,Y as C,ab as F,ba as M,ca as T,dc as g,fc as b,gb as x,ib as m,ka as Q,la as v,ma as h,mb as z,ob as S,tb as i,ub as n,va as L,vb as c,zb as O}from"./chunk-UISEBZIM.js";var _e=(()=>{class t{constructor(e){this.apiService=e}getSummary(){return this.apiService.get("financial/summary")}static{this.\u0275fac=function(r){return new(r||t)(H(ee))}}static{this.\u0275prov=W({token:t,factory:t.\u0275fac,providedIn:"root"})}}return t})();var Ee=["amountInput"],Me=t=>({"btn-disabled opacity-50":t});function Te(t,s){if(t&1){let e=O();i(0,"div",19)(1,"div",20),f("click",function(){let l=v(e).$implicit,u=d(2);return h(u.selectedCategory=l)}),i(2,"div",21),c(3,"i"),n(),i(4,"span",22),o(5),n()()()}if(t&2){let e=s.$implicit,r=d(2);a(),m("ngClass",(r.selectedCategory==null?null:r.selectedCategory.id)===e.id?"border-900 surface-50":"surface-border"),a(),m("className","w-2rem h-2rem border-round-circle flex align-items-center justify-content-center "+e.colorClass),a(),z(e.icon+" text-sm"),a(2),w(e.name)}}function Fe(t,s){if(t&1){let e=O();i(0,"div",2)(1,"div",3),f("click",function(l){return v(e),h(l.stopPropagation())}),i(2,"h3",4),o(3),n(),i(4,"form",5),f("ngSubmit",function(){v(e);let l=d();return h(l.save())}),i(5,"div",6)(6,"span",7),o(7,"Monto"),n(),i(8,"div",8)(9,"span",9),o(10,"S/"),n(),i(11,"input",10,0),N("ngModelChange",function(l){v(e);let u=d();return I(u.amount,l)||(u.amount=l),h(l)}),n()()(),i(13,"div",11)(14,"span",12),o(15,"Categor\xEDa"),n(),i(16,"div",13),x(17,Te,6,5,"div",14),n()(),i(18,"div",15)(19,"button",16),f("click",function(){v(e);let l=d();return h(l.close())}),o(20," Cancelar "),n(),i(21,"button",17),o(22," Guardar "),n()()()(),i(23,"div",18),f("click",function(){v(e);let l=d();return h(l.close())}),n()()}if(t&2){let e=d();a(2),m("ngClass",e.titleColor),a(),p(" Registrar ",e.type==="INGRESO"?"Ingreso":"Gasto"," "),a(5),m("ngClass",e.amount?"border-primary":"surface-border"),a(3),k("ngModel",e.amount),a(6),m("ngForOf",e.currentCategories),a(4),m("disabled",!e.isValid)("ngClass",K(7,Me,!e.isValid))}}var ye=(()=>{class t{constructor(){this.visible=!1,this.type="INGRESO",this.visibleChange=new L,this.saved=new L,this.amount=null,this.selectedCategory=null,this.incomeCategories=[{id:1,name:"Venta",icon:"fas fa-tshirt",colorClass:"bg-green-100 text-green-600"},{id:2,name:"Capital",icon:"fas fa-wallet",colorClass:"bg-blue-100 text-blue-600"}],this.expenseCategories=[{id:1,name:"Pasaje",icon:"fas fa-bus",colorClass:"bg-red-100 text-red-600"},{id:2,name:"Comida",icon:"fas fa-utensils",colorClass:"bg-orange-100 text-orange-600"},{id:3,name:"Puesto",icon:"fas fa-store",colorClass:"bg-purple-100 text-purple-600"},{id:4,name:"Otros",icon:"fas fa-ellipsis-h",colorClass:"surface-200 text-600"}]}ngOnChanges(e){e.visible&&e.visible.currentValue===!0&&setTimeout(()=>{this.amountInput&&this.amountInput.nativeElement.focus()},100)}get currentCategories(){return this.type==="INGRESO"?this.incomeCategories:this.expenseCategories}get titleColor(){return this.type==="INGRESO"?"text-green-600":"text-red-600"}get isValid(){return this.amount&&this.amount>0&&this.selectedCategory}close(){this.visible=!1,this.visibleChange.emit(!1),setTimeout(()=>{this.amount=null,this.selectedCategory=null},200)}save(){if(!this.isValid){console.warn("Formulario inv\xE1lido: Falta monto o categor\xEDa");return}this.saved.emit({type:this.type,amount:this.amount,category:this.selectedCategory}),this.close()}static{this.\u0275fac=function(r){return new(r||t)}}static{this.\u0275cmp=M({type:t,selectors:[["app-transaction-modal"]],viewQuery:function(r,l){if(r&1&&U(Ee,5),r&2){let u;Y(u=q())&&(l.amountInput=u.first)}},inputs:{visible:"visible",type:"type"},outputs:{visibleChange:"visibleChange",saved:"saved"},standalone:!0,features:[Q,V],decls:1,vars:1,consts:[["amountInput",""],["class","fixed top-0 left-0 w-full h-full z-5 flex align-items-center justify-content-center","style","background-color: rgba(15, 23, 42, 0.4); backdrop-filter: blur(4px)",4,"ngIf"],[1,"fixed","top-0","left-0","w-full","h-full","z-5","flex","align-items-center","justify-content-center",2,"background-color","rgba(15, 23, 42, 0.4)","backdrop-filter","blur(4px)"],[1,"surface-card","border-round-2xl","shadow-8","p-5","w-full","max-w-25rem","m-3","slide-up","relative",3,"click"],[1,"text-xl","font-bold","mb-4","m-0",3,"ngClass"],[3,"ngSubmit"],[1,"mb-4"],[1,"text-xs","font-bold","text-500","block","mb-2"],[1,"flex","align-items-center","border-bottom-2","py-2","transition-colors","duration-200",3,"ngClass"],[1,"text-2xl","font-bold","text-400","mr-2"],["type","number","name","amount","placeholder","0.00",1,"w-full","text-3xl","font-bold","border-none","outline-none","text-900","bg-transparent",3,"ngModelChange","ngModel"],[1,"mb-5"],[1,"text-xs","font-bold","text-500","block","mb-3"],[1,"grid","formgrid"],["class","col-6 mb-3",4,"ngFor","ngForOf"],[1,"flex","gap-3"],["type","button",1,"w-full","surface-200","text-700","font-bold","py-3","border-round-xl","border-none","cursor-pointer","hover:surface-300","transition-colors",3,"click"],["type","submit",1,"w-full","bg-bluegray-900","text-white","font-bold","py-3","border-round-xl","border-none","cursor-pointer","hover:bg-bluegray-800","transition-colors","shadow-3",3,"disabled","ngClass"],[1,"absolute","inset-0","z-minus-1",3,"click"],[1,"col-6","mb-3"],[1,"cursor-pointer","border-1","border-round-xl","p-3","flex","align-items-center","gap-3","transition-all","transition-duration-200","hover:surface-50",3,"click","ngClass"],[3,"className"],[1,"font-bold","text-sm","text-900"]],template:function(r,l){r&1&&x(0,Fe,24,9,"div",1),r&2&&m("ngIf",l.visible)},dependencies:[_,j,X,Z,me,le,ie,se,ne,oe,re,ae],styles:['@charset "UTF-8";.slide-up[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_slideUp .3s ease-out}@keyframes _ngcontent-%COMP%_slideUp{0%{transform:translateY(20px);opacity:0}to{transform:translateY(0);opacity:1}}.btn-disabled[_ngcontent-%COMP%]{opacity:.5;cursor:not-allowed!important}']})}}return t})();var ke=(t,s)=>({"bg-green-100 text-green-700":t,"bg-red-100 text-red-700":s}),Ie=(t,s)=>({"pi-money-bill text-green-500":t,"pi-mobile text-purple-500":s});function Ne(t,s){t&1&&c(0,"p-skeleton",3)}function Ve(t,s){if(t&1&&(i(0,"div",15)(1,"div",16),c(2,"i",17),n(),i(3,"div")(4,"p",18),o(5," Caja Total "),n(),i(6,"h3",19),o(7),g(8,"number"),n()(),i(9,"div",20)(10,"span",21),o(11," Efec: "),i(12,"strong",22),o(13),g(14,"number"),n()(),i(15,"span",21),o(16," Dig: "),i(17,"strong",22),o(18),g(19,"number"),n()()()()),t&2){let e=d();a(7),p(" S/ ",b(8,3,e.cards().cash_total.amount,"1.2-2")," "),a(6),p("S/ ",b(14,6,e.cards().cash_total.cash,"1.0-0"),""),a(5),p("S/ ",b(19,9,e.cards().cash_total.digital,"1.0-0"),"")}}function je(t,s){t&1&&c(0,"p-skeleton",3)}function De(t,s){if(t&1&&(i(0,"div",23)(1,"div",24)(2,"div",25),c(3,"i",26),n(),i(4,"span",27),c(5,"i",28),o(6),n()(),i(7,"div")(8,"p",29),o(9," Ingresos Ventas "),n(),i(10,"h3",30),o(11),g(12,"number"),n()()()),t&2){let e=d();a(6),G(" ",e.cards().sales_income.growth>0?"+":"","",e.cards().sales_income.growth,"% "),a(5),p(" S/ ",b(12,3,e.cards().sales_income.amount,"1.2-2")," ")}}function Le(t,s){t&1&&c(0,"p-skeleton",3)}function Oe(t,s){if(t&1&&(i(0,"div",23)(1,"div",24)(2,"div",31),c(3,"i",32),n()(),i(4,"div")(5,"p",29),o(6," Gastos Operativos "),n(),i(7,"h3",30),o(8),g(9,"number"),n(),i(10,"p",33),o(11),n()()()),t&2){let e=d();a(8),p(" S/ ",b(9,2,e.cards().expenses.amount,"1.2-2")," "),a(3),p(" ",e.cards().expenses.description," ")}}function Ge(t,s){t&1&&c(0,"p-skeleton",3)}function Pe(t,s){if(t&1&&(i(0,"div",23)(1,"div",24)(2,"div",34),c(3,"i",35),n()(),i(4,"div")(5,"p",29),o(6," Inversi\xF3n Stock "),n(),i(7,"h3",30),o(8),g(9,"number"),n(),i(10,"p",33),o(11),n()()()),t&2){let e=d();a(8),p(" S/ ",b(9,2,e.cards().stock_investment.amount,"1.2-2")," "),a(3),p(" ",e.cards().stock_investment.description," ")}}function Be(t,s){t&1&&(i(0,"tr",36)(1,"th",37),o(2,"Concepto"),n(),i(3,"th",38),o(4,"Categor\xEDa"),n(),i(5,"th",38),o(6,"Fecha"),n(),i(7,"th",38),o(8,"M\xE9todo"),n(),i(9,"th",39),o(10,"Monto"),n()())}function Re(t,s){if(t&1&&(i(0,"tr",40)(1,"td",41),o(2),n(),i(3,"td",38)(4,"span",42),o(5),n()(),i(6,"td",43),o(7),n(),i(8,"td",38)(9,"div",44),c(10,"i",45),o(11),n()(),i(12,"td",39)(13,"span",46),o(14),g(15,"number"),n()()()),t&2){let e=s.$implicit;a(2),w(e.concept),a(2),m("ngClass",P(12,ke,e.category==="Venta"||e.category==="Ingreso",e.category==="Gasto")),a(),p(" ",e.category," "),a(2),w(e.date),a(3),m("ngClass",P(15,Ie,e.method==="CASH",e.method!=="CASH")),a(),p(" ",e.method," "),a(2),m("ngClass",e.type==="income"?"text-green-600":"text-red-600"),a(),G(" ",e.type==="income"?"+":"-"," S/ ",b(15,9,e.amount,"1.2-2")," ")}}function Ae(t,s){t&1&&(i(0,"tr")(1,"td",47),c(2,"i",48),o(3," No hay movimientos recientes registrados. "),n()())}var Ce=(()=>{class t{constructor(){this.financialSummaryService=C(_e),this.cashflowService=C(be),this.currentDate=new Date,this.datePipe=C(B),this.messageService=C(A),this.loading=F(!0),this.cards=F({cash_total:{amount:0,cash:0,digital:0},sales_income:{amount:0,growth:0},expenses:{amount:0,description:""},stock_investment:{amount:0,description:""}}),this.transactions=F([]),this.showModal=!1,this.modalType="INGRESO"}ngOnInit(){this.loadDashboardData()}loadDashboardData(){this.loading.set(!0),this.financialSummaryService.getSummary().subscribe({next:e=>{this.cards.set(e.cards),this.transactions.set(e.recent_transactions),this.loading.set(!1)},error:e=>{console.error("Error cargando dashboard",e),this.loading.set(!1)}})}openTransactionModal(e){this.modalType=e,this.showModal=!0}handleTransactionSave(e){this.cashflowService.registerSummaryMovement(e).subscribe({next:r=>{r.success&&(this.messageService.add({severity:"success",summary:"Guardado",detail:"Movimiento registrado correctamente"}),this.showModal=!1,this.loadDashboardData())},error:r=>{console.error(r),this.messageService.add({severity:"error",summary:"Error",detail:"No se pudo registrar el movimiento"})}})}static{this.\u0275fac=function(r){return new(r||t)}}static{this.\u0275cmp=M({type:t,selectors:[["app-financial-summary"]],standalone:!0,features:[J([B,A]),V],decls:26,vars:9,consts:[[1,"flex","flex-column","gap-4","p-4","fadein-animation"],[1,"grid"],[1,"col-12","md:col-3"],["height","10rem","borderRadius","16px"],[1,"surface-card","border-round-2xl","border-1","surface-border","shadow-2","overflow-hidden"],[1,"p-4","border-bottom-1","surface-border","flex","flex-column","sm:flex-row","justify-content-between","align-items-center","gap-3"],[1,"font-bold","text-800","m-0","text-xl"],[1,"flex","gap-2"],["pButton","","label","Ingreso","icon","pi pi-plus",1,"p-button-success","p-button-outlined","p-button-sm","border-round-lg","font-bold",3,"click"],["pButton","","label","Gasto","icon","pi pi-minus",1,"p-button-danger","p-button-outlined","p-button-sm","border-round-lg","font-bold",3,"click"],["styleClass","p-datatable-sm",3,"value","loading","rowHover"],["pTemplate","header"],["pTemplate","body"],["pTemplate","emptymessage"],[3,"visibleChange","saved","visible","type"],[1,"bg-bluegray-900","border-round-2xl","p-4","text-white","shadow-4","relative","overflow-hidden","h-full","flex","flex-column","justify-content-between"],[1,"absolute","top-0","right-0","p-3","opacity-10"],[1,"pi","pi-wallet","text-6xl"],[1,"text-gray-400","text-xs","font-bold","uppercase","mb-2",2,"letter-spacing","1px"],[1,"text-4xl","font-bold","m-0","text-white"],[1,"flex","gap-2","text-xs","mt-3"],[1,"surface-800","p-2","border-round","border-1","border-700","text-gray-300"],[1,"text-white"],[1,"surface-card","border-round-2xl","p-4","border-1","surface-border","shadow-2","h-full","flex","flex-column","justify-content-between"],[1,"flex","justify-content-between","mb-3"],[1,"w-3rem","h-3rem","bg-green-50","border-round-lg","flex","align-items-center","justify-content-center","text-green-600"],[1,"pi","pi-arrow-down","text-xl","font-bold"],[1,"text-xs","font-bold","text-green-700","bg-green-100","px-2","py-1","border-round-2xl","h-fit","flex","align-items-center","gap-1"],[1,"pi","pi-chart-line","text-xs"],[1,"text-500","text-xs","font-bold","uppercase","m-0"],[1,"text-3xl","font-bold","text-900","mt-2","mb-0"],[1,"w-3rem","h-3rem","bg-red-50","border-round-lg","flex","align-items-center","justify-content-center","text-red-500"],[1,"pi","pi-arrow-up","text-xl","font-bold"],[1,"text-xs","text-400","mt-1","m-0"],[1,"w-3rem","h-3rem","bg-blue-50","border-round-lg","flex","align-items-center","justify-content-center","text-blue-600"],[1,"pi","pi-shopping-bag","text-xl","font-bold"],[1,"text-xs","uppercase","surface-50","text-500"],[1,"p-3","pl-4"],[1,"p-3"],[1,"p-3","pr-4","text-right"],[1,"border-bottom-1","surface-border","hover:surface-50","transition-colors"],[1,"p-3","pl-4","font-medium","text-900"],[1,"px-2","py-1","border-round","text-xs","font-bold","inline-block",3,"ngClass"],[1,"p-3","text-600","text-sm"],[1,"flex","align-items-center","gap-2","text-700","text-sm"],[1,"pi",3,"ngClass"],[1,"font-bold","text-lg",3,"ngClass"],["colspan","5",1,"text-center","p-5","text-500"],[1,"pi","pi-inbox","text-4xl","mb-2","block","text-300"]],template:function(r,l){r&1&&(i(0,"div",0)(1,"div",1)(2,"div",2),x(3,Ne,1,0,"p-skeleton",3)(4,Ve,20,12),n(),i(5,"div",2),x(6,je,1,0,"p-skeleton",3)(7,De,13,6),n(),i(8,"div",2),x(9,Le,1,0,"p-skeleton",3)(10,Oe,12,5),n(),i(11,"div",2),x(12,Ge,1,0,"p-skeleton",3)(13,Pe,12,5),n()(),i(14,"div",4)(15,"div",5)(16,"h3",6),o(17,"\xDAltimos Movimientos"),n(),i(18,"div",7)(19,"button",8),f("click",function(){return l.openTransactionModal("INGRESO")}),n(),i(20,"button",9),f("click",function(){return l.openTransactionModal("GASTO")}),n()()(),i(21,"p-table",10),x(22,Be,11,0,"ng-template",11)(23,Re,16,18,"ng-template",12)(24,Ae,4,0,"ng-template",13),n()()(),i(25,"app-transaction-modal",14),N("visibleChange",function(y){return I(l.showModal,y)||(l.showModal=y),y}),f("saved",function(y){return l.handleTransactionSave(y)}),n()),r&2&&(a(3),S(3,l.loading()?3:4),a(3),S(6,l.loading()?6:7),a(3),S(9,l.loading()?9:10),a(3),S(12,l.loading()?12:13),a(9),m("value",l.transactions())("loading",l.loading())("rowHover",!0),a(4),k("visible",l.showModal),m("type",l.modalType))},dependencies:[_,j,$,pe,de,te,xe,fe,ue,ge,ce,he,ve,ye]})}}return t})();var We=[{path:"",component:Ce},{path:"",pathMatch:"full",redirectTo:"financial-summary"}],Se=(()=>{class t{static{this.\u0275fac=function(r){return new(r||t)}}static{this.\u0275mod=T({type:t})}static{this.\u0275inj=E({imports:[R.forChild(We),R]})}}return t})();var St=(()=>{class t{static{this.\u0275fac=function(r){return new(r||t)}}static{this.\u0275mod=T({type:t})}static{this.\u0275inj=E({imports:[_,Se]})}}return t})();export{St as FinancialSummaryModule};
