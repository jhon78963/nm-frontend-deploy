import{a as F}from"./chunk-5KB4FRNX.js";import{a as pe,b as de}from"./chunk-YXZCRUU2.js";import{a as U,b as W,c as b}from"./chunk-FTM6AZP4.js";import{B as D,a as te,l as ne,m as T,n as se,o as ae,p as le,s as me,z as ce}from"./chunk-PHRFU6X7.js";import"./chunk-G7756MNA.js";import"./chunk-3LHITKBJ.js";import"./chunk-444HQADF.js";import{d as oe,e as re}from"./chunk-UXKUMFFU.js";import"./chunk-SU5FXICQ.js";import{d as ie,e as _}from"./chunk-JLFYD4SE.js";import"./chunk-3JYME56N.js";import"./chunk-CPF55P7Y.js";import{g as v,k as S}from"./chunk-KJUOHDYT.js";import{d as X,g as C,h as Y,j as Z,l as $,o as y,v as ee,w as R,x as M}from"./chunk-VPEJC4WG.js";import{Aa as G,Ab as g,B as f,C as h,H as k,I as O,Ra as J,Sa as K,Tb as A,Ua as x,V as c,W as r,cb as L,d as E,db as P,fa as z,ha as l,na as q,q as V,sa as m,ta as s,ua as p,w as u,xb as Q,ya as H,za as d}from"./chunk-DIPV63T5.js";var w=class{constructor(j){this.id=j.id,this.name=j.name}};function Ce(t,j){if(t&1){let e=H();m(0,"form",1),d("ngSubmit",function(){k(e);let o=G();return O(o.buttonSaveRole())}),m(1,"div",2)(2,"div",3),p(3,"app-input-text",4),s(),p(4,"button",5),s()()}if(t&2){let e=G();l("formGroup",e.form),c(4),l("disabled",!e.isValid)}}var B=(()=>{class t{constructor(e,i,o,n){this.formBuilder=e,this.rolesService=i,this.dynamicDialogRef=o,this.dynamicDialogConfig=n,this.form=this.formBuilder.group({name:["",X.required]})}ngOnInit(){if(this.dynamicDialogConfig.data.id){let e=this.dynamicDialogConfig.data.id;this.rolesService.getOne(e).subscribe(i=>{this.form.patchValue(i)})}}get isValid(){return this.form.valid}buttonSaveRole(){if(this.form){let e=new w(this.form.value);if(this.dynamicDialogConfig.data.id){let i=this.dynamicDialogConfig.data.id;this.rolesService.edit(i,e).subscribe({next:()=>this.dynamicDialogRef.close(),error:()=>{}})}else this.rolesService.create(e).subscribe({next:()=>{this.dynamicDialogRef.close({success:!0}),this.form.reset()},error:()=>{}})}}static{this.\u0275fac=function(i){return new(i||t)(r(ee),r(F),r(W),r(U))}}static{this.\u0275cmp=f({type:t,selectors:[["app-roles-form"]],decls:1,vars:1,consts:[[3,"formGroup"],[3,"ngSubmit","formGroup"],[1,"p-fluid","p-formgrid","grid"],[1,"col-12"],["label","Rol","for","role","type","text","id","role","placeholder","Ingresa el rol","controlName","name"],["type","submit","pButton","","label","Guardar",1,"mt-3",3,"disabled"]],template:function(i,o){i&1&&z(0,Ce,5,2,"form",0),i&2&&q(0,o.form?0:-1)},dependencies:[oe,$,C,te,y]})}}return t})();var ye=()=>[],Re=()=>[10,20,50],ue=(()=>{class t{constructor(e,i,o,n,a){this.dialogService=e,this.rolesService=i,this.messageService=o,this.confirmationService=n,this.loadingService=a,this.columns=[],this.data=[],this.limit=10,this.page=1,this.name="",this.callToAction=[{type:"button",size:"small",icon:"pi pi-pencil",outlined:!0,pTooltip:"Editar",tooltipPosition:"bottom",click:I=>this.buttonEditRole(I.id)},{type:"button",size:"small",icon:"pi pi-trash",outlined:!0,pTooltip:"Eliminar",tooltipPosition:"bottom",click:(I,he)=>this.buttonDeleteRole(I.id,he)}],this.formGroup=new Y({search:new Z(null)})}ngOnInit(){this.columns=[{header:"#",field:"id",clickable:!1,image:!1,money:!1},{header:"Rol",field:"name",clickable:!1,image:!1,money:!1},{field:"button",header:"Acci\xF3n",clickable:!1,image:!1,money:!1}],this.getRoles(this.limit,this.page,this.name),this.formGroup.get("search")?.valueChanges.pipe(V(600)).subscribe(e=>{this.name=e||"",this.loadingService.sendLoadingState(!0),this.getRoles(this.limit,this.page,this.name)})}ngOnDestroy(){this.roleModal&&this.roleModal.close()}clearFilter(){this.name="",this.loadingService.sendLoadingState(!0),this.formGroup.get("search")?.setValue("")}updatePage(e){this.page=e}getRoles(){return E(this,arguments,function*(e=this.limit,i=this.page,o=this.name){this.updatePage(i),this.rolesService.callGetList(e,i,o).subscribe(),setTimeout(()=>{this.loadingService.sendLoadingState(!1)},600)})}get roles(){return this.rolesService.getList()}get total(){return this.rolesService.getTotal()}onPageSelected(e){return E(this,null,function*(){this.updatePage((e.page??0)+1),this.getRoles(e.rows,this.page)})}buttonAddRole(){this.roleModal=this.dialogService.open(B,{data:{},header:"Crear"}),this.roleModal.onClose.subscribe({next:e=>{e&&e?.success?this.showSuccess("Role Creado."):e?.error&&this.showError(e?.error)}})}buttonEditRole(e){this.roleModal=this.dialogService.open(B,{data:{id:e},header:"Editar"}),this.roleModal.onClose.subscribe({next:i=>{i&&i?.success?this.showSuccess("Role actualizado."):i?.error&&this.showError(i?.error)}})}buttonDeleteRole(e,i){this.confirmationService.confirm({target:i.target,message:"Deseas eliminar este rol?",header:"Eliminar rol",icon:"pi pi-info-circle",acceptButtonStyleClass:"p-button-danger p-button-text",rejectButtonStyleClass:"p-button-text p-button-text",acceptIcon:"none",rejectIcon:"none",acceptLabel:"Si",rejectLabel:"No",accept:()=>{this.rolesService.delete(e).subscribe(()=>{this.showSuccess("El rol ha sido eliminado")})},reject:()=>{}})}showSuccess(e){this.messageService.add({severity:"success",summary:"Confirmado",detail:e,life:3e3})}showError(e){this.messageService.add({severity:"error",summary:"Error",detail:e,life:3e3})}static{this.\u0275fac=function(i){return new(i||t)(r(b),r(F),r(S),r(v),r(ae))}}static{this.\u0275cmp=f({type:t,selectors:[["app-roles"]],standalone:!0,features:[J([v,S]),K],decls:10,vars:15,consts:[[1,"card"],[1,"flex","justify-content-between","align-items-center","mt-3","gap-3"],["controlName","search",1,"w-full","md:w-3",3,"clearFilter","formGroup"],[3,"click","outlined"],[1,"pi","pi-plus",2,"font-size","1rem"],[3,"paginateSelected","data","columns","callToAction","cellToAction","total","limit","rowsPerPageOptions"]],template:function(i,o){if(i&1&&(m(0,"div",0)(1,"div",1)(2,"app-input-search",2),d("clearFilter",function(){return o.clearFilter()}),s(),m(3,"p-button",3),d("click",function(){return o.buttonAddRole()}),p(4,"i",4),s()(),m(5,"app-table-pagination",5),L(6,"async"),L(7,"async"),d("paginateSelected",function(a){return o.onPageSelected(a)}),s(),p(8,"p-toast")(9,"p-confirmDialog"),s()),i&2){let n,a;c(2),l("formGroup",o.formGroup),c(),l("outlined",!0),c(2),l("data",(n=P(6,9,o.roles))!==null&&n!==void 0?n:x(13,ye))("columns",o.columns)("callToAction",o.callToAction)("cellToAction",o.cellToAction)("total",(a=P(7,11,o.total))!==null&&a!==void 0?a:0)("limit",o.limit)("rowsPerPageOptions",x(14,Re))}},dependencies:[g,Q,R,C,M,y,T,ne,re,_,ie,D,le,ce]})}}return t})();var Me=[{path:"",component:ue},{path:"",pathMatch:"full",redirectTo:"roles"}],fe=(()=>{class t{static{this.\u0275fac=function(i){return new(i||t)}}static{this.\u0275mod=h({type:t})}static{this.\u0275inj=u({imports:[A.forChild(Me),A]})}}return t})();var li=(()=>{class t{static{this.\u0275fac=function(i){return new(i||t)}}static{this.\u0275mod=h({type:t})}static{this.\u0275inj=u({providers:[b],imports:[g,fe,D,R,M,_,T,pe,de,se,me]})}}return t})();export{li as RolesModule};
