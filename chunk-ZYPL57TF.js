import{a as he,c as fe}from"./chunk-DDFZ54IY.js";import{c as I}from"./chunk-ODTFD3QQ.js";import"./chunk-TVFTUAXU.js";import{a as Se}from"./chunk-UIFM43AP.js";import{A as _e,B as ge,f as ae,g as ce,h as pe,i as de,t as me,u as ue}from"./chunk-QGEUABJK.js";import"./chunk-R5IEJ2W2.js";import"./chunk-OHBNF7H4.js";import"./chunk-BLSNVWGO.js";import{b as oe}from"./chunk-7HYQIZLR.js";import{d as se,f as le}from"./chunk-53BCAK53.js";import{d as X}from"./chunk-NELNUKEX.js";import"./chunk-KZGPV3OV.js";import"./chunk-MROZGMZP.js";import"./chunk-6MWK2YGG.js";import"./chunk-S23T3VNK.js";import"./chunk-ZSZR532A.js";import{k as x,p as j,q as W,t as Y,u as Z}from"./chunk-56NTXRTG.js";import{b as ee,f as te,k as ie,w as ne,x as re}from"./chunk-3IAGLYRS.js";import{f as J,h as K,i as U}from"./chunk-DIBFAAWP.js";import{A as E,Ab as p,Bb as m,Eb as y,Lb as d,Nb as B,Pb as S,Qb as h,Ra as c,Rb as f,Rc as H,S as R,Sa as u,Sb as A,T as D,Tb as G,Uc as T,Vb as w,X as N,ba as V,ca as O,d as L,dc as Q,ec as q,gb as z,ib as _,la as l,m as P,ma as a,mb as F,ob as $,tb as o,ub as r,vb as v,x as M,zb as C}from"./chunk-UISEBZIM.js";var ye=(()=>{class s{static \u0275fac=function(i){return new(i||s)};static \u0275mod=O({type:s});static \u0275inj=D({imports:[T,W,W]})}return s})();var ve=(()=>{class s{constructor(e){this.apiService=e}add(e,i,t){return this.apiService.post(`products/${e}/size/${i}`,t)}get(e,i){return this.apiService.get(`products/${e}/size/${i}`)}remove(e,i){return this.apiService.delete(`products/${e}/size/${i}`)}update(e,i,t){return this.apiService.patch(`products/${e}/size/${i}`,t)}getProductSizeId(e,i){return this.apiService.get(`products/${e}/size/${i}`)}static{this.\u0275fac=function(i){return new(i||s)(N(X))}}static{this.\u0275prov=R({token:s,factory:s.\u0275fac,providedIn:"root"})}}return s})();var we=()=>["/inventories/products"],Te=()=>[],xe=()=>({"min-width":"50rem"});function Ie(s,k){s&1&&(o(0,"tr")(1,"th",15),v(2,"p-tableHeaderCheckbox"),r(),o(3,"th"),d(4,"#"),r(),o(5,"th"),d(6,"Talla"),r(),o(7,"th"),d(8,"C\xF3digo de barras"),r(),o(9,"th"),d(10,"Stock"),r(),o(11,"th"),d(12,"Precio de compra"),r(),o(13,"th"),d(14,"Precio de venta"),r(),o(15,"th"),d(16,"Precio de venta m\xEDnimo"),r(),v(17,"th"),r())}function ke(s,k){if(s&1){let e=C();o(0,"button",26),p("click",function(){l(e);let t=m().$implicit,n=m();return a(n.removeSizeProductButton(t))}),r()}}function Pe(s,k){if(s&1){let e=C();o(0,"tr")(1,"td"),v(2,"p-tableCheckbox",16),r(),o(3,"td",17)(4,"span",18),d(5,"Code"),r(),d(6),r(),o(7,"td",19)(8,"span",18),d(9,"Name"),r(),d(10),r(),o(11,"td",20)(12,"div",21)(13,"input",22),f("ngModelChange",function(t){let n=l(e).$implicit;return h(n.barcode,t)||(n.barcode=t),a(t)}),p("keyup",function(){let t=l(e).$implicit,n=m();return a(n.selectSize(t))}),r()()(),o(14,"td",20)(15,"div",21)(16,"input",22),f("ngModelChange",function(t){let n=l(e).$implicit;return h(n.stock,t)||(n.stock=t),a(t)}),p("keyup",function(){let t=l(e).$implicit,n=m();return a(n.selectSize(t))}),r()()(),o(17,"td",20)(18,"div",21)(19,"input",22),f("ngModelChange",function(t){let n=l(e).$implicit;return h(n.purchasePrice,t)||(n.purchasePrice=t),a(t)}),p("keyup",function(){let t=l(e).$implicit,n=m();return a(n.selectSize(t))}),r()()(),o(20,"td",20)(21,"div",21)(22,"input",22),f("ngModelChange",function(t){let n=l(e).$implicit;return h(n.salePrice,t)||(n.salePrice=t),a(t)}),p("keyup",function(){let t=l(e).$implicit,n=m();return a(n.selectSize(t))}),r()()(),o(23,"td",20)(24,"div",21)(25,"input",22),f("ngModelChange",function(t){let n=l(e).$implicit;return h(n.minSalePrice,t)||(n.minSalePrice=t),a(t)}),p("keyup",function(){let t=l(e).$implicit,n=m();return a(n.selectSize(t))}),r()()(),o(26,"td")(27,"div",23)(28,"button",24),p("click",function(){let t=l(e).$implicit,n=m();return a(t.isExists?n.editSizeProductButton(t):n.saveSizeProductButton(t))}),r(),z(29,ke,1,0,"button",25),r()()()}if(s&2){let e=k.$implicit;c(2),_("value",e),c(4),B(" ",e.id," "),c(4),B(" ",e.description," "),c(3),y("value",e.barcode),S("ngModel",e.barcode),c(3),y("value",e.stock),S("ngModel",e.stock),c(3),y("value",e.purchasePrice),S("ngModel",e.purchasePrice),c(3),y("value",e.salePrice),S("ngModel",e.salePrice),c(3),y("value",e.minSalePrice),S("ngModel",e.minSalePrice),c(3),_("icon",e.isExists?"pi pi-pencil":"pi pi-save"),c(),$(29,e.isExists?29:-1)}}var ut=(()=>{class s{constructor(e,i,t,n,b,g,ze){this.router=e,this.route=i,this.dialogService=t,this.messageService=n,this.productSizesService=b,this.productsService=g,this.sizesSelectedService=ze,this.productId=0,this.sizeTypeId=0,this.filter=!0,this.products=[],this.sizeTypes=[],this.selectedSizes=[],this.selectedSizeTypeIds=[1],this.cols=[],this.stepper=!0,this.route.snapshot.paramMap.get("id")&&(this.productId=Number(this.route.snapshot.paramMap.get("id")),this.stepper=this.router.url.includes("/step/"))}onGlobalFilter(e,i){e.filterGlobal(i.target.value,"contains")}ngOnInit(){this.getSizes(),this.getSizeTypes()}getSizeTypes(){this.sizesSelectedService.getSizeTypes().subscribe({next:e=>{this.sizeTypes=e}})}getSizes(){return L(this,null,function*(){this.productId!==0&&this.productsService.getOne(this.productId).subscribe({next:e=>{this.filter=e.filter,this.selectedSizeTypeIds=e.sizeTypeId.length?e.sizeTypeId:[1],this.sizesSelectedService.callGetList(this.productId,this.selectedSizeTypeIds).subscribe()}})})}get sizes(){return this.sizesSelectedService.getList()}handleSizeTypeSelection(e){this.selectedSizeTypeIds=e,this.sizesSelectedService.callGetList(this.productId,this.selectedSizeTypeIds).subscribe()}createSize(){this.dialogService.open(fe,{data:{productId:this.productId,sizeTypeId:this.sizeTypeId||this.selectedSizeTypeIds},header:"Crear Talla",styleClass:"dialog-custom-form"}).onClose.subscribe({next:i=>{i&&i?.success?me(this.messageService,"Talla Creada."):i?.error&&ue(this.messageService,"Hubo un error, intente nuevamente")}})}selectSize(e){this.selectedSizes.some(n=>n.id===e.id)||(this.selectedSizes=[...this.selectedSizes,e]),!e.barcode?.toString().trim()&&!e.stock?.toString().trim()&&!e.purchasePrice?.toString().trim()&&!e.salePrice?.toString().trim()&&!e.minSalePrice?.toString().trim()&&(this.selectedSizes=this.selectedSizes.filter(n=>n.id!==e.id))}saveAllSelectedSizes(){let e=this.selectedSizes.map(i=>{let t={barcode:i.barcode,stock:i.stock,purchasePrice:i.purchasePrice,salePrice:i.salePrice,minSalePrice:i.minSalePrice};return this.productSizesService.add(this.productId,i.id,t).pipe(E(()=>P(null)))});M(e).subscribe({next:()=>{this.getSizes(),this.selectedSizes=[]}})}deleteAllSelectedSizes(){let e=this.selectedSizes.map(i=>this.productSizesService.remove(this.productId,i.id).pipe(E(()=>P(null))));M(e).subscribe({next:()=>{this.getSizes(),this.selectedSizes=[]}})}saveSizeProductButton(e){let i={barcode:e.barcode,stock:e.stock,purchasePrice:e.purchasePrice,salePrice:e.salePrice,minSalePrice:e.minSalePrice};this.productSizesService.add(this.productId,e.id,i).subscribe({next:()=>{this.getSizes(),this.selectedSizes=this.selectedSizes.filter(t=>t.id!==e.id)},error:()=>this.getSizes()})}editSizeProductButton(e){this.saveSizeProductButton(e)}removeSizeProductButton(e){this.productSizesService.remove(this.productId,e.id).subscribe({next:()=>{this.getSizes(),this.selectedSizes=this.selectedSizes.filter(i=>i.id!==e.id)},error:()=>this.getSizes()})}static{this.\u0275fac=function(i){return new(i||s)(u(K),u(J),u(I),u(x),u(ve),u(Se),u(he))}}static{this.\u0275cmp=V({type:s,selectors:[["app-sizes-form"]],standalone:!0,features:[A([I,x]),G],decls:17,vars:15,consts:[["dt",""],[1,"col-12","mt-0"],[1,"w-full"],[1,"flex","flex-column","md:flex-row","md:justify-content-between"],[1,"flex","justify-content-center","md:justify-content-start","gap-2","mb-3"],[3,"selectionChange","collection","selectedIds"],[1,"flex","justify-content-center","md:justify-content-end","gap-2","mb-3"],[1,"flex","flex-wrap","justify-content-center","gap-2"],["pButton","","pRipple","","label","Nuevo","icon","pi pi-plus","severity","secondary","size","small",1,"btn-menu","w-9rem",3,"click"],["pButton","","pRipple","","label","Guardar","icon","pi pi-save","severity","secondary","size","small",1,"btn-menu","w-9rem",3,"click","disabled"],["pButton","","pRipple","","label","Remover","icon","pi pi-trash","severity","secondary","size","small",1,"btn-menu","w-9rem",3,"click","disabled"],["pButton","","pRipple","","label","Regresar","icon","pi pi-arrow-left","severity","help","size","small",1,"btn-menu-back","w-9rem",3,"routerLink"],["responsiveLayout","scroll","selectionMode","multiple","dataKey","id",3,"selectionChange","value","tableStyle","selection"],["pTemplate","header"],["pTemplate","body"],[2,"width","3rem"],[3,"value"],[2,"width","5%","min-width","10rem"],[1,"p-column-title"],[2,"width","10%","min-width","10rem"],[2,"width","14%","min-width","10rem"],[1,"bg-input-text"],["type","text",1,"input-text",3,"ngModelChange","keyup","value","ngModel"],[1,"flex","justify-content-end","gap-2"],["pButton","","pRipple","",1,"p-button-rounded","p-menu",3,"click","icon"],["pButton","","pRipple","","icon","pi pi-trash",1,"p-button-rounded","p-menu"],["pButton","","pRipple","","icon","pi pi-trash",1,"p-button-rounded","p-menu",3,"click"]],template:function(i,t){if(i&1){let n=C();o(0,"div")(1,"div",1)(2,"div",2)(3,"div",3)(4,"div",4)(5,"app-input-filter",5),p("selectionChange",function(g){return l(n),a(t.handleSizeTypeSelection(g))}),r()(),o(6,"div",6)(7,"div",7)(8,"button",8),p("click",function(){return l(n),a(t.createSize())}),r(),o(9,"button",9),p("click",function(){return l(n),a(t.saveAllSelectedSizes())}),r(),o(10,"button",10),p("click",function(){return l(n),a(t.deleteAllSelectedSizes())}),r(),v(11,"button",11),r()()(),o(12,"p-table",12,0),Q(14,"async"),f("selectionChange",function(g){return l(n),h(t.selectedSizes,g)||(t.selectedSizes=g),a(g)}),z(15,Ie,18,0,"ng-template",13)(16,Pe,30,15,"ng-template",14),r()()()()}if(i&2){let n;F(t.stepper?"":" card"),c(5),_("collection",t.sizeTypes)("selectedIds",t.selectedSizeTypeIds),c(4),_("disabled",!t.selectedSizes||!t.selectedSizes.length),c(),_("disabled",!t.selectedSizes||!t.selectedSizes.length),c(),_("routerLink",w(12,we)),c(),_("value",(n=q(14,10,t.sizes))!==null&&n!==void 0?n:w(13,Te))("tableStyle",w(14,xe)),S("selection",t.selectedSizes)}},dependencies:[T,H,ye,j,de,ae,ce,pe,le,se,oe,Z,Y,re,ee,te,ne,ie,ge,_e,U],styles:[".p-toolbar{padding:0;padding-left:1.25rem}  .btn-menu{background-color:#dfe3e8;border:1px solid #dfe3e8;color:#475569;border-radius:5px;height:39px}  .btn-menu-back{background-color:#ffb340;border:1px solid #ffb340;color:#000;border-radius:5px;height:39px}  .btn-selected{background-color:#75787b;color:#fff}  .p-datatable.p-datatable-hoverable-rows .p-datatable-tbody>tr:not(.p-highlight):hover{background:#0003;color:#475569}.bg-input-text[_ngcontent-%COMP%]   input.input-text[_ngcontent-%COMP%]{background-color:#f0f0f0;border-radius:62px;border:none;width:100%;height:48px;text-align:center;padding:1rem}.bg-input-text[_ngcontent-%COMP%]   input.input-text[_ngcontent-%COMP%]:focus-visible{outline:none}  .dialog-custom-form{width:30%!important;height:auto!important}  .dialog-custom-assign{width:15%!important;height:auto!important}@media (max-width: 480px){  .dialog-custom-form{width:70%!important;height:auto!important}  .dialog-custom-assign{width:70%!important;height:auto!important}}"]})}}return s})();export{ut as SizesFormComponent};
